{% verbatim %}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>ahk_blockly_test</title> 

<script src="https://cdn.rawgit.com/brython-dev/brython/3.7.5/www/src/brython.js"></script>
<script>//https://stackoverflow.com/questions/26360414/javascript-how-to-correct-indentation-in-html-string
function FormatHTML(str) {

    var div = document.createElement('div');
    div.innerHTML = str.trim();

    return FormatNode(div, 0).innerHTML;
}

function FormatNode(node, level) {

    var indentBefore = new Array(level++ + 1).join('  '),
        indentAfter = new Array(level - 1).join('  '),
        textNode;

    for (var i = 0; i < node.children.length; i++) {

        textNode = document.createTextNode('\n' + indentBefore);
        node.insertBefore(textNode, node.children[i]);

        FormatNode(node.children[i], level);

        if (node.lastElementChild == node.children[i]) {
            textNode = document.createTextNode('\n' + indentAfter);
            node.appendChild(textNode);
        }
    }

    return node;
}

//https://stackoverflow.com/questions/3665115/how-to-create-a-file-in-memory-for-user-to-download-but-not-through-server#answer-18197341
function DownloadTextFile(filename, text) {
    var element = document.createElement('a');
    text = text.replace(/\n/g, "\r\n"); //LT to CRLF https://stackoverflow.com/questions/3665115/how-to-create-a-file-in-memory-for-user-to-download-but-not-through-server#answer-18197341
    var universalBOM = "\uFEFF"; //utf-8 with bom https://stackoverflow.com/questions/42462764/javascript-export-csv-encoding-utf-8-issue
    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(universalBOM + text));
    element.setAttribute('download', filename);
    element.style.display = 'none';
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
}</script>
<script src="https://blockly-demo.appspot.com/static/blockly_compressed.js"></script>
<script src="https://blockly-demo.appspot.com/static/blocks_compressed.js"></script>
<script>var hotstring_color = "#CD5C5C";
var hotstringSetting_color = "#D0873E";

Blockly.Blocks['my_textarea'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextArea());
        this.setColour(230);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['built_in_webpage'] = {
    init: function() {
        this.appendDummyInput()
            .setAlign(Blockly.ALIGN_CENTRE)
            .appendField(new Blockly.FieldDropdown([
                ["Google網頁", "google"],
                ["Youtube網頁", "youtube"],
                ["Facebook網頁", "facebook"],
                ["Wikipedia網頁", "wikipedia"],
                ["PChome網頁", "pchome"],
                ["Yahoo網頁", "yahoo"],
                ["Google地圖", "googlemap"],
                ["AHK官網", "ahk"],
                ["AHK積木網頁", "ahkblockly"],
            ]), "NAME");
        this.setOutput(true, "String");
        this.setColour(290);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['built_in_time'] = {
    init: function() {
        this.appendDummyInput()
            .setAlign(Blockly.ALIGN_CENTRE)
            .appendField(new Blockly.FieldDropdown([
                ["現年(YYYY)", "year"],
                ["現月(01-12)", "month"],
                ["現日(01-31)", "day"],
                ["現星期(1-7)", "wday"],
                ["現時(00-23)", "hour"],
                ["現分(00-59)", "min"],
                ["現秒(00-59)", "sec"],
            ]), "NAME");
        this.setOutput(true, "Number");
        this.setColour(230);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['built_in_program'] = {
    init: function() {
        this.appendDummyInput()
            .setAlign(Blockly.ALIGN_CENTRE)
            .appendField(new Blockly.FieldDropdown([
                ["記事本", "notepad"],
                ["小畫家", "mspaint"],
                ["小算盤", "calc"],
                ["剪取工具", "SnippingTool"],
                ["命令提示字元", "cmd"],
                ["AHK腳本", "ahkfile"],
                ["AHK主程式", "ahkexe"],
            ]), "NAME");
        this.setOutput(true, "filepath");
        this.setColour(290);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['built_in_dirpath'] = {
    init: function() {
        this.appendDummyInput()
            .setAlign(Blockly.ALIGN_CENTRE)
            .appendField(new Blockly.FieldDropdown([
                ["桌面", "desktop"],
                ["我的文件", "mydocuments"],
                ["啟動資料夾", "startup"],
                ["臨時資料夾", "temp"],
                ["Windows資料夾", "windows"],
                ["AHK腳本目錄", "ahkfilepath"],
            ]), "NAME");
        this.setOutput(true, "dirpath");
        this.setColour(290);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['path_combined'] = {
    init: function() {
        this.appendValueInput("main_path")
            .setCheck("dirpath")
            .appendField("路徑");
        this.appendValueInput("sub_path")
            .setCheck(["dirpath", "filepath"])
            .appendField("底下的");
        this.setInputsInline(true);
        this.setOutput(true, "dirpath");
        this.setColour(290);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['send_keys'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("送出連續按鍵")
            .appendField(new Blockly.FieldTextInput("abc"), "NAME");
        this.setPreviousStatement(true, "action");
        this.setNextStatement(true, "action");
        this.setColour(260);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['send_text'] = {
    init: function() {
        this.appendValueInput("NAME")
            .setCheck(["String", "Number"])
            .appendField("輸入文字");
        this.setPreviousStatement(true, "action");
        this.setNextStatement(true, "action");
        this.setColour(160);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};


Blockly.Blocks['hotstring_do'] = {
    init: function() {
        this.appendValueInput("ABB")
            .setCheck("String")
            .setAlign(Blockly.ALIGN_RIGHT)
            .appendField("當輸入");
        this.appendStatementInput("DO")
            .setCheck("action")
            .setAlign(Blockly.ALIGN_RIGHT)
            .appendField("執行");
        this.appendStatementInput("SETTING")
            .setCheck("hotstring_setting")
            .setAlign(Blockly.ALIGN_RIGHT)
            .appendField("設定");
        this.setColour(hotstring_color);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['hotstringSetting_autoExpaned'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("立即展開而不用按下終止鍵 (如空格、Enter、Tab...)");
        this.setPreviousStatement(true, "hotstring_setting");
        this.setNextStatement(true, "hotstring_setting");
        this.setColour(hotstringSetting_color);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};
Blockly.Blocks['hotstringSetting_dontFireEndKey'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("展開後不觸發終止鍵");
        this.setPreviousStatement(true, "hotstring_setting");
        this.setNextStatement(true, "hotstring_setting");
        this.setColour(hotstringSetting_color);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};
Blockly.Blocks['hotstringSetting_caseSensitive'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("縮寫區分大小寫");
        this.setPreviousStatement(true, "hotstring_setting");
        this.setNextStatement(true, "hotstring_setting");
        this.setColour(hotstringSetting_color);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};
Blockly.Blocks['hotstringSetting_expanedInWrods'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("可在字詞間觸發");
        this.setPreviousStatement(true, "hotstring_setting");
        this.setNextStatement(true, "hotstring_setting");
        this.setColour(hotstringSetting_color);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};
Blockly.Blocks['hotstringSetting_rawText'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("使用{TEXT}展開 (可展開中文)");
        this.setPreviousStatement(true, "hotstring_setting");
        this.setNextStatement(true, "hotstring_setting");
        this.setColour(hotstringSetting_color);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['hotstring_advanced'] = {
    init: function() {
        this.appendValueInput("ABB")
            .setCheck("String")
            .setAlign(Blockly.ALIGN_RIGHT)
            .appendField("輸入縮寫");
        this.appendValueInput("TEXT")
            .setCheck(["String", "Number"])
            .setAlign(Blockly.ALIGN_RIGHT)
            .appendField("展開為");
        this.appendStatementInput("SETTING")
            .setCheck("hotstring_setting")
            .appendField("設定");
        this.setInputsInline(false);
        this.setColour(hotstring_color);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['hotstring'] = {
    init: function() {
        this.appendValueInput("ABB")
            .setCheck("String")
            .setAlign(Blockly.ALIGN_RIGHT)
            .appendField("輸入縮寫");
        this.appendValueInput("TEXT")
            .setCheck(["String", "Number"])
            .setAlign(Blockly.ALIGN_RIGHT)
            .appendField("按下Enter展開為");
        this.setInputsInline(false);
        this.setColour(hotstring_color);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['send_key'] = {
    init: function() {
        this.appendValueInput("NAME")
            .setCheck(["normal_key", "function_key", "special_key"])
            .appendField("送出按鍵");
        this.setPreviousStatement(true, "action");
        this.setNextStatement(true, "action");
        this.setColour(260);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['send_key_times'] = {
    init: function() {
        this.appendValueInput("KEY")
            .setCheck(["normal_key", "function_key", "special_key"])
            .appendField("送出按鍵");
        this.appendValueInput("TIMES")
            .setCheck("Number")
            .appendField("按");
        this.appendDummyInput()
            .appendField("次");
        this.setInputsInline(true);
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(260);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['close_process'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("終止程式")
            .appendField(new Blockly.FieldTextInput("*.exe"), "NAME");
        this.setPreviousStatement(true, "action");
        this.setNextStatement(true, "action");
        this.setColour(260);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['file_recycle_empty'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("清空資源回收桶");
        this.setPreviousStatement(true, "action");
        this.setNextStatement(true, "action");
        this.setColour(260);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};



Blockly.Blocks['filepath'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("檔案路徑")
            .appendField(new Blockly.FieldTextInput(""), "NAME");
        this.setOutput(true, "filepath");
        this.setColour(290);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['dirpath'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("目錄路徑")
            .appendField(new Blockly.FieldTextInput("C:\\"), "NAME");
        this.setOutput(true, "dirpath");
        this.setColour(290);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};


Blockly.Blocks['webpage'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("網頁")
            .appendField(new Blockly.FieldTextInput("https://www.google.com"), "NAME");
        this.setOutput(true, "link");
        this.setColour(290);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};


Blockly.Blocks['open'] = {
    init: function() {
        this.appendValueInput("NAME")
            .setCheck(["dirpath", "filepath", "link"])
            .appendField("開啟");
        this.setPreviousStatement(true, "action");
        this.setNextStatement(true, "action");
        this.setColour(260);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['hotkey_execute'] = {
    init: function() {
        this.appendValueInput("NAME")
            .setCheck(["normal_key", "function_key", "special_key"])
            .setAlign(Blockly.ALIGN_RIGHT)
            .appendField("當按下");
        this.appendStatementInput("DO")
            .setCheck("action")
            .setAlign(Blockly.ALIGN_RIGHT)
            .appendField("執行");
        this.setColour(230);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['function_key'] = {
    init: function() {
        this.appendValueInput("function_key")
            .setCheck(["function_key", "normal_key", "special_key"])
            .appendField(new Blockly.FieldDropdown([
                ["Ctrl", "Ctrl"],
                ["Shift", "Shift"],
                ["Alt", "Alt"],
                ["Win", "Win"],
                ["LCtrl", "LCtrl"],
                ["LShift", "LShift"],
                ["LAlt", "LAlt"],
                ["LWin", "LWin"],
                ["RCtrl", "RCtrl"],
                ["RShift", "RShift"],
                ["RAlt", "RAlt"],
                ["RWin", "RWin"],
            ]), "function_key").appendField("+");
        this.setOutput(true, "function_key");
        this.setColour(230);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['normal_key'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldDropdown([
                ["A", "A"],
                ["B", "B"],
                ["C", "C"],
                ["D", "D"],
                ["E", "E"],
                ["F", "F"],
                ["G", "G"],
                ["H", "H"],
                ["I", "I"],
                ["J", "J"],
                ["K", "K"],
                ["L", "L"],
                ["M", "M"],
                ["N", "N"],
                ["O", "O"],
                ["P", "P"],
                ["Q", "Q"],
                ["R", "R"],
                ["S", "S"],
                ["T", "T"],
                ["U", "U"],
                ["V", "V"],
                ["W", "W"],
                ["X", "X"],
                ["Y", "Y"],
                ["Z", "Z"],
            ]), "normal_key");
        this.setOutput(true, "normal_key");
        this.setColour(230);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['special_key'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldDropdown([
                ["Enter", "Enter"],
                ["Space", "Space"],
                ["Tab", "Tab"],
                ["CapsLock", "CapsLock"],
                ["Esc", "Esc"],
                ["Backspace", "Backspace"],
                ["Delete", "Delete"],
                ["Home", "Home"],
                ["End", "End"],
                ["PgUp", "PgUp"],
                ["PgDn", "PgDn"],
                ["Insert", "Insert"],
                ["PrintScreen", "PrintScreen"],
                ["AppsKey", "AppsKey"],
                ["ScrollLock", "ScrollLock"],
                ["Pause", "Pause"],
                ["滑鼠左鍵", "LButton"],
                ["滑鼠右鍵", "RButton"],
                ["滑鼠中鍵", "MButton"],
                ["滑鼠上滾", "WheelUp"],
                ["滑鼠下滾", "WheelDown"],
                ["↑", "Up"],
                ["↓", "Down"],
                ["←", "Left"],
                ["→", "Right"],
                ["Numpad0", "Numpad0"],
                ["Numpad1", "Numpad1"],
                ["Numpad2", "Numpad2"],
                ["Numpad3", "Numpad3"],
                ["Numpad4", "Numpad4"],
                ["Numpad5", "Numpad5"],
                ["Numpad6", "Numpad6"],
                ["Numpad7", "Numpad7"],
                ["Numpad8", "Numpad8"],
                ["Numpad9", "Numpad9"],
                ["Numpad.", "Numpad."],
                ["Numpad/", "Numpad/"],
                ["Numpad*", "Numpad*"],
                ["Numpad-", "Numpad-"],
                ["Numpad+", "Numpad+"],
                ["NumpadEnter", "NumpadEnter"],
                ["NumLock", "NumLock"],
                ["`", "`"],
                ["0", "0"],
                ["1", "1"],
                ["2", "2"],
                ["3", "3"],
                ["4", "4"],
                ["5", "5"],
                ["6", "6"],
                ["7", "7"],
                ["8", "8"],
                ["9", "9"],
                ["－", "-"],
                ["＝", "="],
                ["［", "["],
                ["］", "]"],
                ["＼", "\\"],
                ["；", "`;"],
                ["’", "'"],
                ["，", "`,"],
                ["．", "."],
                ["／", "/"],
                ["F1", "F1"],
                ["F2", "F2"],
                ["F3", "F3"],
                ["F4", "F4"],
                ["F5", "F5"],
                ["F6", "F6"],
                ["F7", "F7"],
                ["F8", "F8"],
                ["F9", "F9"],
                ["F10", "F10"],
                ["F11", "F11"],
                ["F12", "F12"],
            ]), "special_key");
        this.setOutput(true, "special_key");
        this.setColour(230);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};



Blockly.Blocks['msgbox'] = {
    init: function() {
        this.appendValueInput("NAME")
            .setCheck(null)
            .appendField("跳出訊息");
        this.setPreviousStatement(true, "action");
        this.setNextStatement(true, "action");
        this.setColour(160);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};</script>
<script>// This file was automatically generated.  Do not modify.

'use strict';

goog.provide('Blockly.Msg.en');

goog.require('Blockly.Msg');

Blockly.Msg["ADD_COMMENT"] = "增加註解";
Blockly.Msg["CANNOT_DELETE_VARIABLE_PROCEDURE"] = "Can't delete the variable '%1' because it's part of the definition of the function '%2'";
Blockly.Msg["CHANGE_VALUE_TITLE"] = "Change value:";
Blockly.Msg["CLEAN_UP"] = "Clean up Blocks";
Blockly.Msg["COLLAPSED_WARNINGS_WARNING"] = "Collapsed blocks contain warnings.";
Blockly.Msg["COLLAPSE_ALL"] = "收合所有積木";
Blockly.Msg["COLLAPSE_BLOCK"] = "收合積木";
Blockly.Msg["COLOUR_BLEND_COLOUR1"] = "colour 1";
Blockly.Msg["COLOUR_BLEND_COLOUR2"] = "colour 2";
Blockly.Msg["COLOUR_BLEND_HELPURL"] = "https://meyerweb.com/eric/tools/color-blend/#:::rgbp";
Blockly.Msg["COLOUR_BLEND_RATIO"] = "ratio";
Blockly.Msg["COLOUR_BLEND_TITLE"] = "blend";
Blockly.Msg["COLOUR_BLEND_TOOLTIP"] = "Blends two colours together with a given ratio (0.0 - 1.0).";
Blockly.Msg["COLOUR_PICKER_HELPURL"] = "https://en.wikipedia.org/wiki/Color";
Blockly.Msg["COLOUR_PICKER_TOOLTIP"] = "Choose a colour from the palette.";
Blockly.Msg["COLOUR_RANDOM_HELPURL"] = "http://randomcolour.com";
Blockly.Msg["COLOUR_RANDOM_TITLE"] = "random colour";
Blockly.Msg["COLOUR_RANDOM_TOOLTIP"] = "Choose a colour at random.";
Blockly.Msg["COLOUR_RGB_BLUE"] = "blue";
Blockly.Msg["COLOUR_RGB_GREEN"] = "green";
Blockly.Msg["COLOUR_RGB_HELPURL"] = "https://www.december.com/html/spec/colorpercompact.html";
Blockly.Msg["COLOUR_RGB_RED"] = "red";
Blockly.Msg["COLOUR_RGB_TITLE"] = "colour with";
Blockly.Msg["COLOUR_RGB_TOOLTIP"] = "Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.";
Blockly.Msg["CONTROLS_FLOW_STATEMENTS_HELPURL"] = "https://github.com/google/blockly/wiki/Loops#loop-termination-blocks";
Blockly.Msg["CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK"] = "break out of loop";
Blockly.Msg["CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE"] = "continue with next iteration of loop";
Blockly.Msg["CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK"] = "Break out of the containing loop.";
Blockly.Msg["CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE"] = "Skip the rest of this loop, and continue with the next iteration.";
Blockly.Msg["CONTROLS_FLOW_STATEMENTS_WARNING"] = "Warning: This block may only be used within a loop.";
Blockly.Msg["CONTROLS_FOREACH_HELPURL"] = "https://github.com/google/blockly/wiki/Loops#for-each";
Blockly.Msg["CONTROLS_FOREACH_TITLE"] = "for each item %1 in list %2";
Blockly.Msg["CONTROLS_FOREACH_TOOLTIP"] = "For each item in a list, set the variable '%1' to the item, and then do some statements.";
Blockly.Msg["CONTROLS_FOR_HELPURL"] = "https://github.com/google/blockly/wiki/Loops#count-with";
Blockly.Msg["CONTROLS_FOR_TITLE"] = "count with %1 from %2 to %3 by %4";
Blockly.Msg["CONTROLS_FOR_TOOLTIP"] = "Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.";
Blockly.Msg["CONTROLS_IF_ELSEIF_TOOLTIP"] = "Add a condition to the if block.";
Blockly.Msg["CONTROLS_IF_ELSE_TOOLTIP"] = "Add a final, catch-all condition to the if block.";
Blockly.Msg["CONTROLS_IF_HELPURL"] = "https://github.com/google/blockly/wiki/IfElse";
Blockly.Msg["CONTROLS_IF_IF_TOOLTIP"] = "Add, remove, or reorder sections to reconfigure this if block.";
Blockly.Msg["CONTROLS_IF_MSG_ELSE"] = "else";
Blockly.Msg["CONTROLS_IF_MSG_ELSEIF"] = "else if";
Blockly.Msg["CONTROLS_IF_MSG_IF"] = "if";
Blockly.Msg["CONTROLS_IF_TOOLTIP_1"] = "If a value is true, then do some statements.";
Blockly.Msg["CONTROLS_IF_TOOLTIP_2"] = "If a value is true, then do the first block of statements. Otherwise, do the second block of statements.";
Blockly.Msg["CONTROLS_IF_TOOLTIP_3"] = "If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.";
Blockly.Msg["CONTROLS_IF_TOOLTIP_4"] = "If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.";
Blockly.Msg["CONTROLS_REPEAT_HELPURL"] = "https://en.wikipedia.org/wiki/For_loop";
Blockly.Msg["CONTROLS_REPEAT_INPUT_DO"] = "do";
Blockly.Msg["CONTROLS_REPEAT_TITLE"] = "repeat %1 times";
Blockly.Msg["CONTROLS_REPEAT_TOOLTIP"] = "Do some statements several times.";
Blockly.Msg["CONTROLS_WHILEUNTIL_HELPURL"] = "https://github.com/google/blockly/wiki/Loops#repeat";
Blockly.Msg["CONTROLS_WHILEUNTIL_OPERATOR_UNTIL"] = "repeat until";
Blockly.Msg["CONTROLS_WHILEUNTIL_OPERATOR_WHILE"] = "repeat while";
Blockly.Msg["CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL"] = "While a value is false, then do some statements.";
Blockly.Msg["CONTROLS_WHILEUNTIL_TOOLTIP_WHILE"] = "While a value is true, then do some statements.";
Blockly.Msg["DELETE_ALL_BLOCKS"] = "刪除 all %1 blocks?";
Blockly.Msg["DELETE_BLOCK"] = "刪除";
Blockly.Msg["DELETE_VARIABLE"] = "刪除 '%1' 變數";
Blockly.Msg["DELETE_VARIABLE_CONFIRMATION"] = "刪除 %1 uses of the '%2' variable?";
Blockly.Msg["DELETE_X_BLOCKS"] = "刪除 %1 個積木";
Blockly.Msg["DISABLE_BLOCK"] = "停用積木";
Blockly.Msg["DUPLICATE_BLOCK"] = "複製";
Blockly.Msg["DUPLICATE_COMMENT"] = "複製註解";
Blockly.Msg["ENABLE_BLOCK"] = "啟用積木";
Blockly.Msg["EXPAND_ALL"] = "展開所有積木";
Blockly.Msg["EXPAND_BLOCK"] = "展開積木";
Blockly.Msg["EXTERNAL_INPUTS"] = "External Inputs";
Blockly.Msg["HELP"] = "說明";
Blockly.Msg["INLINE_INPUTS"] = "Inline Inputs";
Blockly.Msg["IOS_CANCEL"] = "取消";
Blockly.Msg["IOS_ERROR"] = "Error";
Blockly.Msg["IOS_OK"] = "OK";
Blockly.Msg["IOS_PROCEDURES_ADD_INPUT"] = "+ Add Input";
Blockly.Msg["IOS_PROCEDURES_ALLOW_STATEMENTS"] = "Allow statements";
Blockly.Msg["IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR"] = "This function has duplicate inputs.";
Blockly.Msg["IOS_PROCEDURES_INPUTS"] = "INPUTS";
Blockly.Msg["IOS_VARIABLES_ADD_BUTTON"] = "Add";
Blockly.Msg["IOS_VARIABLES_ADD_VARIABLE"] = "+ Add Variable";
Blockly.Msg["IOS_VARIABLES_DELETE_BUTTON"] = "刪除";
Blockly.Msg["IOS_VARIABLES_EMPTY_NAME_ERROR"] = "You can't use an empty variable name.";
Blockly.Msg["IOS_VARIABLES_RENAME_BUTTON"] = "重新命名";
Blockly.Msg["IOS_VARIABLES_VARIABLE_NAME"] = "變數名稱";
Blockly.Msg["LISTS_CREATE_EMPTY_HELPURL"] = "https://github.com/google/blockly/wiki/Lists#create-empty-list";
Blockly.Msg["LISTS_CREATE_EMPTY_TITLE"] = "create empty list";
Blockly.Msg["LISTS_CREATE_EMPTY_TOOLTIP"] = "Returns a list, of length 0, containing no data records";
Blockly.Msg["LISTS_CREATE_WITH_CONTAINER_TITLE_ADD"] = "list";
Blockly.Msg["LISTS_CREATE_WITH_CONTAINER_TOOLTIP"] = "Add, remove, or reorder sections to reconfigure this list block.";
Blockly.Msg["LISTS_CREATE_WITH_HELPURL"] = "https://github.com/google/blockly/wiki/Lists#create-list-with";
Blockly.Msg["LISTS_CREATE_WITH_INPUT_WITH"] = "create list with";
Blockly.Msg["LISTS_CREATE_WITH_ITEM_TOOLTIP"] = "Add an item to the list.";
Blockly.Msg["LISTS_CREATE_WITH_TOOLTIP"] = "Create a list with any number of items.";
Blockly.Msg["LISTS_GET_INDEX_FIRST"] = "first";
Blockly.Msg["LISTS_GET_INDEX_FROM_END"] = "# from end";
Blockly.Msg["LISTS_GET_INDEX_FROM_START"] = "#";
Blockly.Msg["LISTS_GET_INDEX_GET"] = "get";
Blockly.Msg["LISTS_GET_INDEX_GET_REMOVE"] = "get and remove";
Blockly.Msg["LISTS_GET_INDEX_LAST"] = "last";
Blockly.Msg["LISTS_GET_INDEX_RANDOM"] = "random";
Blockly.Msg["LISTS_GET_INDEX_REMOVE"] = "remove";
Blockly.Msg["LISTS_GET_INDEX_TAIL"] = "";
Blockly.Msg["LISTS_GET_INDEX_TOOLTIP_GET_FIRST"] = "Returns the first item in a list.";
Blockly.Msg["LISTS_GET_INDEX_TOOLTIP_GET_FROM"] = "Returns the item at the specified position in a list.";
Blockly.Msg["LISTS_GET_INDEX_TOOLTIP_GET_LAST"] = "Returns the last item in a list.";
Blockly.Msg["LISTS_GET_INDEX_TOOLTIP_GET_RANDOM"] = "Returns a random item in a list.";
Blockly.Msg["LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST"] = "Removes and returns the first item in a list.";
Blockly.Msg["LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM"] = "Removes and returns the item at the specified position in a list.";
Blockly.Msg["LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST"] = "Removes and returns the last item in a list.";
Blockly.Msg["LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM"] = "Removes and returns a random item in a list.";
Blockly.Msg["LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST"] = "Removes the first item in a list.";
Blockly.Msg["LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM"] = "Removes the item at the specified position in a list.";
Blockly.Msg["LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST"] = "Removes the last item in a list.";
Blockly.Msg["LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM"] = "Removes a random item in a list.";
Blockly.Msg["LISTS_GET_SUBLIST_END_FROM_END"] = "to # from end";
Blockly.Msg["LISTS_GET_SUBLIST_END_FROM_START"] = "to #";
Blockly.Msg["LISTS_GET_SUBLIST_END_LAST"] = "to last";
Blockly.Msg["LISTS_GET_SUBLIST_HELPURL"] = "https://github.com/google/blockly/wiki/Lists#getting-a-sublist";
Blockly.Msg["LISTS_GET_SUBLIST_START_FIRST"] = "get sub-list from first";
Blockly.Msg["LISTS_GET_SUBLIST_START_FROM_END"] = "get sub-list from # from end";
Blockly.Msg["LISTS_GET_SUBLIST_START_FROM_START"] = "get sub-list from #";
Blockly.Msg["LISTS_GET_SUBLIST_TAIL"] = "";
Blockly.Msg["LISTS_GET_SUBLIST_TOOLTIP"] = "Creates a copy of the specified portion of a list.";
Blockly.Msg["LISTS_INDEX_FROM_END_TOOLTIP"] = "%1 is the last item.";
Blockly.Msg["LISTS_INDEX_FROM_START_TOOLTIP"] = "%1 is the first item.";
Blockly.Msg["LISTS_INDEX_OF_FIRST"] = "find first occurrence of item";
Blockly.Msg["LISTS_INDEX_OF_HELPURL"] = "https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list";
Blockly.Msg["LISTS_INDEX_OF_LAST"] = "find last occurrence of item";
Blockly.Msg["LISTS_INDEX_OF_TOOLTIP"] = "Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.";
Blockly.Msg["LISTS_INLIST"] = "in list";
Blockly.Msg["LISTS_ISEMPTY_HELPURL"] = "https://github.com/google/blockly/wiki/Lists#is-empty";
Blockly.Msg["LISTS_ISEMPTY_TITLE"] = "%1 is empty";
Blockly.Msg["LISTS_ISEMPTY_TOOLTIP"] = "Returns true if the list is empty.";
Blockly.Msg["LISTS_LENGTH_HELPURL"] = "https://github.com/google/blockly/wiki/Lists#length-of";
Blockly.Msg["LISTS_LENGTH_TITLE"] = "length of %1";
Blockly.Msg["LISTS_LENGTH_TOOLTIP"] = "Returns the length of a list.";
Blockly.Msg["LISTS_REPEAT_HELPURL"] = "https://github.com/google/blockly/wiki/Lists#create-list-with";
Blockly.Msg["LISTS_REPEAT_TITLE"] = "create list with item %1 repeated %2 times";
Blockly.Msg["LISTS_REPEAT_TOOLTIP"] = "Creates a list consisting of the given value repeated the specified number of times.";
Blockly.Msg["LISTS_REVERSE_HELPURL"] = "https://github.com/google/blockly/wiki/Lists#reversing-a-list";
Blockly.Msg["LISTS_REVERSE_MESSAGE0"] = "reverse %1";
Blockly.Msg["LISTS_REVERSE_TOOLTIP"] = "Reverse a copy of a list.";
Blockly.Msg["LISTS_SET_INDEX_HELPURL"] = "https://github.com/google/blockly/wiki/Lists#in-list--set";
Blockly.Msg["LISTS_SET_INDEX_INPUT_TO"] = "as";
Blockly.Msg["LISTS_SET_INDEX_INSERT"] = "insert at";
Blockly.Msg["LISTS_SET_INDEX_SET"] = "set";
Blockly.Msg["LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST"] = "Inserts the item at the start of a list.";
Blockly.Msg["LISTS_SET_INDEX_TOOLTIP_INSERT_FROM"] = "Inserts the item at the specified position in a list.";
Blockly.Msg["LISTS_SET_INDEX_TOOLTIP_INSERT_LAST"] = "Append the item to the end of a list.";
Blockly.Msg["LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM"] = "Inserts the item randomly in a list.";
Blockly.Msg["LISTS_SET_INDEX_TOOLTIP_SET_FIRST"] = "Sets the first item in a list.";
Blockly.Msg["LISTS_SET_INDEX_TOOLTIP_SET_FROM"] = "Sets the item at the specified position in a list.";
Blockly.Msg["LISTS_SET_INDEX_TOOLTIP_SET_LAST"] = "Sets the last item in a list.";
Blockly.Msg["LISTS_SET_INDEX_TOOLTIP_SET_RANDOM"] = "Sets a random item in a list.";
Blockly.Msg["LISTS_SORT_HELPURL"] = "https://github.com/google/blockly/wiki/Lists#sorting-a-list";
Blockly.Msg["LISTS_SORT_ORDER_ASCENDING"] = "ascending";
Blockly.Msg["LISTS_SORT_ORDER_DESCENDING"] = "descending";
Blockly.Msg["LISTS_SORT_TITLE"] = "sort %1 %2 %3";
Blockly.Msg["LISTS_SORT_TOOLTIP"] = "Sort a copy of a list.";
Blockly.Msg["LISTS_SORT_TYPE_IGNORECASE"] = "alphabetic, ignore case";
Blockly.Msg["LISTS_SORT_TYPE_NUMERIC"] = "numeric";
Blockly.Msg["LISTS_SORT_TYPE_TEXT"] = "alphabetic";
Blockly.Msg["LISTS_SPLIT_HELPURL"] = "https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists";
Blockly.Msg["LISTS_SPLIT_LIST_FROM_TEXT"] = "make list from text";
Blockly.Msg["LISTS_SPLIT_TEXT_FROM_LIST"] = "make text from list";
Blockly.Msg["LISTS_SPLIT_TOOLTIP_JOIN"] = "Join a list of texts into one text, separated by a delimiter.";
Blockly.Msg["LISTS_SPLIT_TOOLTIP_SPLIT"] = "Split text into a list of texts, breaking at each delimiter.";
Blockly.Msg["LISTS_SPLIT_WITH_DELIMITER"] = "with delimiter";
Blockly.Msg["LOGIC_BOOLEAN_FALSE"] = "false";
Blockly.Msg["LOGIC_BOOLEAN_HELPURL"] = "https://github.com/google/blockly/wiki/Logic#values";
Blockly.Msg["LOGIC_BOOLEAN_TOOLTIP"] = "Returns either true or false.";
Blockly.Msg["LOGIC_BOOLEAN_TRUE"] = "true";
Blockly.Msg["LOGIC_COMPARE_HELPURL"] = "https://en.wikipedia.org/wiki/Inequality_(mathematics)";
Blockly.Msg["LOGIC_COMPARE_TOOLTIP_EQ"] = "Return true if both inputs equal each other.";
Blockly.Msg["LOGIC_COMPARE_TOOLTIP_GT"] = "Return true if the first input is greater than the second input.";
Blockly.Msg["LOGIC_COMPARE_TOOLTIP_GTE"] = "Return true if the first input is greater than or equal to the second input.";
Blockly.Msg["LOGIC_COMPARE_TOOLTIP_LT"] = "Return true if the first input is smaller than the second input.";
Blockly.Msg["LOGIC_COMPARE_TOOLTIP_LTE"] = "Return true if the first input is smaller than or equal to the second input.";
Blockly.Msg["LOGIC_COMPARE_TOOLTIP_NEQ"] = "Return true if both inputs are not equal to each other.";
Blockly.Msg["LOGIC_NEGATE_HELPURL"] = "https://github.com/google/blockly/wiki/Logic#not";
Blockly.Msg["LOGIC_NEGATE_TITLE"] = "not %1";
Blockly.Msg["LOGIC_NEGATE_TOOLTIP"] = "Returns true if the input is false. Returns false if the input is true.";
Blockly.Msg["LOGIC_NULL"] = "null";
Blockly.Msg["LOGIC_NULL_HELPURL"] = "https://en.wikipedia.org/wiki/Nullable_type";
Blockly.Msg["LOGIC_NULL_TOOLTIP"] = "Returns null.";
Blockly.Msg["LOGIC_OPERATION_AND"] = "and";
Blockly.Msg["LOGIC_OPERATION_HELPURL"] = "https://github.com/google/blockly/wiki/Logic#logical-operations";
Blockly.Msg["LOGIC_OPERATION_OR"] = "or";
Blockly.Msg["LOGIC_OPERATION_TOOLTIP_AND"] = "Return true if both inputs are true.";
Blockly.Msg["LOGIC_OPERATION_TOOLTIP_OR"] = "Return true if at least one of the inputs is true.";
Blockly.Msg["LOGIC_TERNARY_CONDITION"] = "test";
Blockly.Msg["LOGIC_TERNARY_HELPURL"] = "https://en.wikipedia.org/wiki/%3F:";
Blockly.Msg["LOGIC_TERNARY_IF_FALSE"] = "if false";
Blockly.Msg["LOGIC_TERNARY_IF_TRUE"] = "if true";
Blockly.Msg["LOGIC_TERNARY_TOOLTIP"] = "Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.";
Blockly.Msg["MATH_ADDITION_SYMBOL"] = "+";
Blockly.Msg["MATH_ARITHMETIC_HELPURL"] = "https://en.wikipedia.org/wiki/Arithmetic";
Blockly.Msg["MATH_ARITHMETIC_TOOLTIP_ADD"] = "Return the sum of the two numbers.";
Blockly.Msg["MATH_ARITHMETIC_TOOLTIP_DIVIDE"] = "Return the quotient of the two numbers.";
Blockly.Msg["MATH_ARITHMETIC_TOOLTIP_MINUS"] = "Return the difference of the two numbers.";
Blockly.Msg["MATH_ARITHMETIC_TOOLTIP_MULTIPLY"] = "Return the product of the two numbers.";
Blockly.Msg["MATH_ARITHMETIC_TOOLTIP_POWER"] = "Return the first number raised to the power of the second number.";
Blockly.Msg["MATH_ATAN2_HELPURL"] = "https://en.wikipedia.org/wiki/Atan2";
Blockly.Msg["MATH_ATAN2_TITLE"] = "atan2 of X:%1 Y:%2";
Blockly.Msg["MATH_ATAN2_TOOLTIP"] = "Return the arctangent of point (X, Y) in degrees from -180 to 180.";
Blockly.Msg["MATH_CHANGE_HELPURL"] = "https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter";
Blockly.Msg["MATH_CHANGE_TITLE"] = "change %1 by %2";
Blockly.Msg["MATH_CHANGE_TOOLTIP"] = "Add a number to variable '%1'.";
Blockly.Msg["MATH_CONSTANT_HELPURL"] = "https://en.wikipedia.org/wiki/Mathematical_constant";
Blockly.Msg["MATH_CONSTANT_TOOLTIP"] = "Return one of the common constants: π (3.141…), e (2.718…), φ (1.618…), sqrt(2) (1.414…), sqrt(½) (0.707…), or ∞ (infinity).";
Blockly.Msg["MATH_CONSTRAIN_HELPURL"] = "https://en.wikipedia.org/wiki/Clamping_(graphics)";
Blockly.Msg["MATH_CONSTRAIN_TITLE"] = "constrain %1 low %2 high %3";
Blockly.Msg["MATH_CONSTRAIN_TOOLTIP"] = "Constrain a number to be between the specified limits (inclusive).";
Blockly.Msg["MATH_DIVISION_SYMBOL"] = "÷";
Blockly.Msg["MATH_IS_DIVISIBLE_BY"] = "is divisible by";
Blockly.Msg["MATH_IS_EVEN"] = "is even";
Blockly.Msg["MATH_IS_NEGATIVE"] = "is negative";
Blockly.Msg["MATH_IS_ODD"] = "is odd";
Blockly.Msg["MATH_IS_POSITIVE"] = "is positive";
Blockly.Msg["MATH_IS_PRIME"] = "is prime";
Blockly.Msg["MATH_IS_TOOLTIP"] = "Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.";
Blockly.Msg["MATH_IS_WHOLE"] = "is whole";
Blockly.Msg["MATH_MODULO_HELPURL"] = "https://en.wikipedia.org/wiki/Modulo_operation";
Blockly.Msg["MATH_MODULO_TITLE"] = "remainder of %1 ÷ %2";
Blockly.Msg["MATH_MODULO_TOOLTIP"] = "Return the remainder from dividing the two numbers.";
Blockly.Msg["MATH_MULTIPLICATION_SYMBOL"] = "×";
Blockly.Msg["MATH_NUMBER_HELPURL"] = "https://en.wikipedia.org/wiki/Number";
Blockly.Msg["MATH_NUMBER_TOOLTIP"] = "A number.";
Blockly.Msg["MATH_ONLIST_HELPURL"] = "";
Blockly.Msg["MATH_ONLIST_OPERATOR_AVERAGE"] = "average of list";
Blockly.Msg["MATH_ONLIST_OPERATOR_MAX"] = "max of list";
Blockly.Msg["MATH_ONLIST_OPERATOR_MEDIAN"] = "median of list";
Blockly.Msg["MATH_ONLIST_OPERATOR_MIN"] = "min of list";
Blockly.Msg["MATH_ONLIST_OPERATOR_MODE"] = "modes of list";
Blockly.Msg["MATH_ONLIST_OPERATOR_RANDOM"] = "random item of list";
Blockly.Msg["MATH_ONLIST_OPERATOR_STD_DEV"] = "standard deviation of list";
Blockly.Msg["MATH_ONLIST_OPERATOR_SUM"] = "sum of list";
Blockly.Msg["MATH_ONLIST_TOOLTIP_AVERAGE"] = "Return the average (arithmetic mean) of the numeric values in the list.";
Blockly.Msg["MATH_ONLIST_TOOLTIP_MAX"] = "Return the largest number in the list.";
Blockly.Msg["MATH_ONLIST_TOOLTIP_MEDIAN"] = "Return the median number in the list.";
Blockly.Msg["MATH_ONLIST_TOOLTIP_MIN"] = "Return the smallest number in the list.";
Blockly.Msg["MATH_ONLIST_TOOLTIP_MODE"] = "Return a list of the most common item(s) in the list.";
Blockly.Msg["MATH_ONLIST_TOOLTIP_RANDOM"] = "Return a random element from the list.";
Blockly.Msg["MATH_ONLIST_TOOLTIP_STD_DEV"] = "Return the standard deviation of the list.";
Blockly.Msg["MATH_ONLIST_TOOLTIP_SUM"] = "Return the sum of all the numbers in the list.";
Blockly.Msg["MATH_POWER_SYMBOL"] = "^";
Blockly.Msg["MATH_RANDOM_FLOAT_HELPURL"] = "https://en.wikipedia.org/wiki/Random_number_generation";
Blockly.Msg["MATH_RANDOM_FLOAT_TITLE_RANDOM"] = "random fraction";
Blockly.Msg["MATH_RANDOM_FLOAT_TOOLTIP"] = "Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).";
Blockly.Msg["MATH_RANDOM_INT_HELPURL"] = "https://en.wikipedia.org/wiki/Random_number_generation";
Blockly.Msg["MATH_RANDOM_INT_TITLE"] = "random integer from %1 to %2";
Blockly.Msg["MATH_RANDOM_INT_TOOLTIP"] = "Return a random integer between the two specified limits, inclusive.";
Blockly.Msg["MATH_ROUND_HELPURL"] = "https://en.wikipedia.org/wiki/Rounding";
Blockly.Msg["MATH_ROUND_OPERATOR_ROUND"] = "round";
Blockly.Msg["MATH_ROUND_OPERATOR_ROUNDDOWN"] = "round down";
Blockly.Msg["MATH_ROUND_OPERATOR_ROUNDUP"] = "round up";
Blockly.Msg["MATH_ROUND_TOOLTIP"] = "Round a number up or down.";
Blockly.Msg["MATH_SINGLE_HELPURL"] = "https://en.wikipedia.org/wiki/Square_root";
Blockly.Msg["MATH_SINGLE_OP_ABSOLUTE"] = "absolute";
Blockly.Msg["MATH_SINGLE_OP_ROOT"] = "square root";
Blockly.Msg["MATH_SINGLE_TOOLTIP_ABS"] = "Return the absolute value of a number.";
Blockly.Msg["MATH_SINGLE_TOOLTIP_EXP"] = "Return e to the power of a number.";
Blockly.Msg["MATH_SINGLE_TOOLTIP_LN"] = "Return the natural logarithm of a number.";
Blockly.Msg["MATH_SINGLE_TOOLTIP_LOG10"] = "Return the base 10 logarithm of a number.";
Blockly.Msg["MATH_SINGLE_TOOLTIP_NEG"] = "Return the negation of a number.";
Blockly.Msg["MATH_SINGLE_TOOLTIP_POW10"] = "Return 10 to the power of a number.";
Blockly.Msg["MATH_SINGLE_TOOLTIP_ROOT"] = "Return the square root of a number.";
Blockly.Msg["MATH_SUBTRACTION_SYMBOL"] = "-";
Blockly.Msg["MATH_TRIG_ACOS"] = "acos";
Blockly.Msg["MATH_TRIG_ASIN"] = "asin";
Blockly.Msg["MATH_TRIG_ATAN"] = "atan";
Blockly.Msg["MATH_TRIG_COS"] = "cos";
Blockly.Msg["MATH_TRIG_HELPURL"] = "https://en.wikipedia.org/wiki/Trigonometric_functions";
Blockly.Msg["MATH_TRIG_SIN"] = "sin";
Blockly.Msg["MATH_TRIG_TAN"] = "tan";
Blockly.Msg["MATH_TRIG_TOOLTIP_ACOS"] = "Return the arccosine of a number.";
Blockly.Msg["MATH_TRIG_TOOLTIP_ASIN"] = "Return the arcsine of a number.";
Blockly.Msg["MATH_TRIG_TOOLTIP_ATAN"] = "Return the arctangent of a number.";
Blockly.Msg["MATH_TRIG_TOOLTIP_COS"] = "Return the cosine of a degree (not radian).";
Blockly.Msg["MATH_TRIG_TOOLTIP_SIN"] = "Return the sine of a degree (not radian).";
Blockly.Msg["MATH_TRIG_TOOLTIP_TAN"] = "Return the tangent of a degree (not radian).";
Blockly.Msg["NEW_COLOUR_VARIABLE"] = "Create colour variable...";
Blockly.Msg["NEW_NUMBER_VARIABLE"] = "Create number variable...";
Blockly.Msg["NEW_STRING_VARIABLE"] = "Create string variable...";
Blockly.Msg["NEW_VARIABLE"] = "Create variable...";
Blockly.Msg["NEW_VARIABLE_TITLE"] = "New variable name:";
Blockly.Msg["NEW_VARIABLE_TYPE_TITLE"] = "New variable type:";
Blockly.Msg["ORDINAL_NUMBER_SUFFIX"] = "";
Blockly.Msg["PROCEDURES_ALLOW_STATEMENTS"] = "執行區塊";
Blockly.Msg["PROCEDURES_BEFORE_PARAMS"] = "參數:";
Blockly.Msg["PROCEDURES_CALLNORETURN_HELPURL"] = "https://en.wikipedia.org/wiki/Subroutine";
Blockly.Msg["PROCEDURES_CALLNORETURN_TOOLTIP"] = "Run the user-defined function '%1'.";
Blockly.Msg["PROCEDURES_CALLRETURN_HELPURL"] = "https://en.wikipedia.org/wiki/Subroutine";
Blockly.Msg["PROCEDURES_CALLRETURN_TOOLTIP"] = "Run the user-defined function '%1' and use its output.";
Blockly.Msg["PROCEDURES_CALL_BEFORE_PARAMS"] = "參數:";
Blockly.Msg["PROCEDURES_CREATE_DO"] = "創造「%1」函式積木";
Blockly.Msg["PROCEDURES_DEFNORETURN_COMMENT"] = "請按右鍵＞創造函式積木\n來使用此函式積木";
Blockly.Msg["PROCEDURES_DEFNORETURN_DO"] = "";
Blockly.Msg["PROCEDURES_DEFNORETURN_HELPURL"] = "https://en.wikipedia.org/wiki/Subroutine";
Blockly.Msg["PROCEDURES_DEFNORETURN_PROCEDURE"] = "do something";
Blockly.Msg["PROCEDURES_DEFNORETURN_TITLE"] = "";
Blockly.Msg["PROCEDURES_DEFNORETURN_TOOLTIP"] = "Creates a function with no output.";
Blockly.Msg["PROCEDURES_DEFRETURN_HELPURL"] = "https://en.wikipedia.org/wiki/Subroutine";
Blockly.Msg["PROCEDURES_DEFRETURN_RETURN"] = "返回";
Blockly.Msg["PROCEDURES_DEFRETURN_TOOLTIP"] = "Creates a function with an output.";
Blockly.Msg["PROCEDURES_DEF_DUPLICATE_WARNING"] = "Warning: This function has duplicate parameters.";
Blockly.Msg["PROCEDURES_HIGHLIGHT_DEF"] = "Highlight function definition";
Blockly.Msg["PROCEDURES_IFRETURN_HELPURL"] = "http://c2.com/cgi/wiki?GuardClause";
Blockly.Msg["PROCEDURES_IFRETURN_TOOLTIP"] = "If a value is true, then return a second value.";
Blockly.Msg["PROCEDURES_IFRETURN_WARNING"] = "Warning: This block may be used only within a function definition.";
Blockly.Msg["PROCEDURES_MUTATORARG_TITLE"] = "參數名稱:";
Blockly.Msg["PROCEDURES_MUTATORARG_TOOLTIP"] = "Add an input to the function.";
Blockly.Msg["PROCEDURES_MUTATORCONTAINER_TITLE"] = "參數";
Blockly.Msg["PROCEDURES_MUTATORCONTAINER_TOOLTIP"] = "Add, remove, or reorder inputs to this function.";
Blockly.Msg["REDO"] = "Redo";
Blockly.Msg["REMOVE_COMMENT"] = "移除註解";
Blockly.Msg["RENAME_VARIABLE"] = "---------";
Blockly.Msg["RENAME_VARIABLE_TITLE"] = "更名所有 '%1' 變數為:";
Blockly.Msg["TEXT_APPEND_HELPURL"] = "https://github.com/google/blockly/wiki/Text#text-modification";
Blockly.Msg["TEXT_APPEND_TITLE"] = "to %1 append text %2";
Blockly.Msg["TEXT_APPEND_TOOLTIP"] = "Append some text to variable '%1'.";
Blockly.Msg["TEXT_CHANGECASE_HELPURL"] = "https://github.com/google/blockly/wiki/Text#adjusting-text-case";
Blockly.Msg["TEXT_CHANGECASE_OPERATOR_LOWERCASE"] = "to lower case";
Blockly.Msg["TEXT_CHANGECASE_OPERATOR_TITLECASE"] = "to Title Case";
Blockly.Msg["TEXT_CHANGECASE_OPERATOR_UPPERCASE"] = "to UPPER CASE";
Blockly.Msg["TEXT_CHANGECASE_TOOLTIP"] = "Return a copy of the text in a different case.";
Blockly.Msg["TEXT_CHARAT_FIRST"] = "get first letter";
Blockly.Msg["TEXT_CHARAT_FROM_END"] = "get letter # from end";
Blockly.Msg["TEXT_CHARAT_FROM_START"] = "get letter #";
Blockly.Msg["TEXT_CHARAT_HELPURL"] = "https://github.com/google/blockly/wiki/Text#extracting-text";
Blockly.Msg["TEXT_CHARAT_LAST"] = "get last letter";
Blockly.Msg["TEXT_CHARAT_RANDOM"] = "get random letter";
Blockly.Msg["TEXT_CHARAT_TAIL"] = "";
Blockly.Msg["TEXT_CHARAT_TITLE"] = "in text %1 %2";
Blockly.Msg["TEXT_CHARAT_TOOLTIP"] = "Returns the letter at the specified position.";
Blockly.Msg["TEXT_COUNT_HELPURL"] = "https://github.com/google/blockly/wiki/Text#counting-substrings";
Blockly.Msg["TEXT_COUNT_MESSAGE0"] = "count %1 in %2";
Blockly.Msg["TEXT_COUNT_TOOLTIP"] = "Count how many times some text occurs within some other text.";
Blockly.Msg["TEXT_CREATE_JOIN_ITEM_TOOLTIP"] = "Add an item to the text.";
Blockly.Msg["TEXT_CREATE_JOIN_TITLE_JOIN"] = "合併文字";
Blockly.Msg["TEXT_CREATE_JOIN_TOOLTIP"] = "Add, remove, or reorder sections to reconfigure this text block.";
Blockly.Msg["TEXT_GET_SUBSTRING_END_FROM_END"] = "to letter # from end";
Blockly.Msg["TEXT_GET_SUBSTRING_END_FROM_START"] = "to letter #";
Blockly.Msg["TEXT_GET_SUBSTRING_END_LAST"] = "to last letter";
Blockly.Msg["TEXT_GET_SUBSTRING_HELPURL"] = "https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text";
Blockly.Msg["TEXT_GET_SUBSTRING_INPUT_IN_TEXT"] = "in text";
Blockly.Msg["TEXT_GET_SUBSTRING_START_FIRST"] = "get substring from first letter";
Blockly.Msg["TEXT_GET_SUBSTRING_START_FROM_END"] = "get substring from letter # from end";
Blockly.Msg["TEXT_GET_SUBSTRING_START_FROM_START"] = "get substring from letter #";
Blockly.Msg["TEXT_GET_SUBSTRING_TAIL"] = "";
Blockly.Msg["TEXT_GET_SUBSTRING_TOOLTIP"] = "Returns a specified portion of the text.";
Blockly.Msg["TEXT_INDEXOF_HELPURL"] = "https://github.com/google/blockly/wiki/Text#finding-text";
Blockly.Msg["TEXT_INDEXOF_OPERATOR_FIRST"] = "find first occurrence of text";
Blockly.Msg["TEXT_INDEXOF_OPERATOR_LAST"] = "find last occurrence of text";
Blockly.Msg["TEXT_INDEXOF_TITLE"] = "in text %1 %2 %3";
Blockly.Msg["TEXT_INDEXOF_TOOLTIP"] = "Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.";
Blockly.Msg["TEXT_ISEMPTY_HELPURL"] = "https://github.com/google/blockly/wiki/Text#checking-for-empty-text";
Blockly.Msg["TEXT_ISEMPTY_TITLE"] = "%1 is empty";
Blockly.Msg["TEXT_ISEMPTY_TOOLTIP"] = "Returns true if the provided text is empty.";
Blockly.Msg["TEXT_JOIN_HELPURL"] = "https://github.com/google/blockly/wiki/Text#text-creation";
Blockly.Msg["TEXT_JOIN_TITLE_CREATEWITH"] = "合併文字";
Blockly.Msg["TEXT_JOIN_TOOLTIP"] = "Create a piece of text by joining together any number of items.";
Blockly.Msg["TEXT_LENGTH_HELPURL"] = "https://github.com/google/blockly/wiki/Text#text-modification";
Blockly.Msg["TEXT_LENGTH_TITLE"] = "length of %1";
Blockly.Msg["TEXT_LENGTH_TOOLTIP"] = "Returns the number of letters (including spaces) in the provided text.";
Blockly.Msg["TEXT_PRINT_HELPURL"] = "https://github.com/google/blockly/wiki/Text#printing-text";
Blockly.Msg["TEXT_PRINT_TITLE"] = "print %1";
Blockly.Msg["TEXT_PRINT_TOOLTIP"] = "Print the specified text, number or other value.";
Blockly.Msg["TEXT_PROMPT_HELPURL"] = "https://github.com/google/blockly/wiki/Text#getting-input-from-the-user";
Blockly.Msg["TEXT_PROMPT_TOOLTIP_NUMBER"] = "Prompt for user for a number.";
Blockly.Msg["TEXT_PROMPT_TOOLTIP_TEXT"] = "Prompt for user for some text.";
Blockly.Msg["TEXT_PROMPT_TYPE_NUMBER"] = "prompt for number with message";
Blockly.Msg["TEXT_PROMPT_TYPE_TEXT"] = "prompt for text with message";
Blockly.Msg["TEXT_REPLACE_HELPURL"] = "https://github.com/google/blockly/wiki/Text#replacing-substrings";
Blockly.Msg["TEXT_REPLACE_MESSAGE0"] = "replace %1 with %2 in %3";
Blockly.Msg["TEXT_REPLACE_TOOLTIP"] = "Replace all occurances of some text within some other text.";
Blockly.Msg["TEXT_REVERSE_HELPURL"] = "https://github.com/google/blockly/wiki/Text#reversing-text";
Blockly.Msg["TEXT_REVERSE_MESSAGE0"] = "reverse %1";
Blockly.Msg["TEXT_REVERSE_TOOLTIP"] = "Reverses the order of the characters in the text.";
Blockly.Msg["TEXT_TEXT_HELPURL"] = "https://en.wikipedia.org/wiki/String_(computer_science)";
Blockly.Msg["TEXT_TEXT_TOOLTIP"] = "A letter, word, or line of text.";
Blockly.Msg["TEXT_TRIM_HELPURL"] = "https://github.com/google/blockly/wiki/Text#trimming-removing-spaces";
Blockly.Msg["TEXT_TRIM_OPERATOR_BOTH"] = "trim spaces from both sides of";
Blockly.Msg["TEXT_TRIM_OPERATOR_LEFT"] = "trim spaces from left side of";
Blockly.Msg["TEXT_TRIM_OPERATOR_RIGHT"] = "trim spaces from right side of";
Blockly.Msg["TEXT_TRIM_TOOLTIP"] = "Return a copy of the text with spaces removed from one or both ends.";
Blockly.Msg["TODAY"] = "Today";
Blockly.Msg["UNDO"] = "Undo";
Blockly.Msg["VARIABLES_DEFAULT_NAME"] = "項目";
Blockly.Msg["VARIABLES_GET_CREATE_SET"] = "創造「%1」賦值積木";
Blockly.Msg["VARIABLES_GET_HELPURL"] = "https://github.com/google/blockly/wiki/Variables#get";
Blockly.Msg["VARIABLES_GET_TOOLTIP"] = "Returns the value of this variable.";
Blockly.Msg["VARIABLES_SET"] = "設 %1 為 %2";
Blockly.Msg["VARIABLES_SET_CREATE_GET"] = "創造「%1」變數積木";
Blockly.Msg["VARIABLES_SET_HELPURL"] = "https://github.com/google/blockly/wiki/Variables#set";
Blockly.Msg["VARIABLES_SET_TOOLTIP"] = "Sets this variable to be equal to the input.";
Blockly.Msg["VARIABLE_ALREADY_EXISTS"] = "A variable named '%1' already exists.";
Blockly.Msg["VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE"] = "A variable named '%1' already exists for another type: '%2'.";
Blockly.Msg["WORKSPACE_COMMENT_DEFAULT_TEXT"] = "Say something...";
Blockly.Msg["CONTROLS_FOREACH_INPUT_DO"] = Blockly.Msg["CONTROLS_REPEAT_INPUT_DO"];
Blockly.Msg["CONTROLS_FOR_INPUT_DO"] = Blockly.Msg["CONTROLS_REPEAT_INPUT_DO"];
Blockly.Msg["CONTROLS_IF_ELSEIF_TITLE_ELSEIF"] = Blockly.Msg["CONTROLS_IF_MSG_ELSEIF"];
Blockly.Msg["CONTROLS_IF_ELSE_TITLE_ELSE"] = Blockly.Msg["CONTROLS_IF_MSG_ELSE"];
Blockly.Msg["CONTROLS_IF_IF_TITLE_IF"] = Blockly.Msg["CONTROLS_IF_MSG_IF"];
Blockly.Msg["CONTROLS_IF_MSG_THEN"] = Blockly.Msg["CONTROLS_REPEAT_INPUT_DO"];
Blockly.Msg["CONTROLS_WHILEUNTIL_INPUT_DO"] = Blockly.Msg["CONTROLS_REPEAT_INPUT_DO"];
Blockly.Msg["LISTS_CREATE_WITH_ITEM_TITLE"] = Blockly.Msg["VARIABLES_DEFAULT_NAME"];
Blockly.Msg["LISTS_GET_INDEX_HELPURL"] = Blockly.Msg["LISTS_INDEX_OF_HELPURL"];
Blockly.Msg["LISTS_GET_INDEX_INPUT_IN_LIST"] = Blockly.Msg["LISTS_INLIST"];
Blockly.Msg["LISTS_GET_SUBLIST_INPUT_IN_LIST"] = Blockly.Msg["LISTS_INLIST"];
Blockly.Msg["LISTS_INDEX_OF_INPUT_IN_LIST"] = Blockly.Msg["LISTS_INLIST"];
Blockly.Msg["LISTS_SET_INDEX_INPUT_IN_LIST"] = Blockly.Msg["LISTS_INLIST"];
Blockly.Msg["MATH_CHANGE_TITLE_ITEM"] = Blockly.Msg["VARIABLES_DEFAULT_NAME"];
Blockly.Msg["PROCEDURES_DEFRETURN_COMMENT"] = Blockly.Msg["PROCEDURES_DEFNORETURN_COMMENT"];
Blockly.Msg["PROCEDURES_DEFRETURN_DO"] = Blockly.Msg["PROCEDURES_DEFNORETURN_DO"];
Blockly.Msg["PROCEDURES_DEFRETURN_PROCEDURE"] = Blockly.Msg["PROCEDURES_DEFNORETURN_PROCEDURE"];
Blockly.Msg["PROCEDURES_DEFRETURN_TITLE"] = Blockly.Msg["PROCEDURES_DEFNORETURN_TITLE"];
Blockly.Msg["TEXT_APPEND_VARIABLE"] = Blockly.Msg["VARIABLES_DEFAULT_NAME"];
Blockly.Msg["TEXT_CREATE_JOIN_ITEM_TITLE_ITEM"] = Blockly.Msg["VARIABLES_DEFAULT_NAME"];

Blockly.Msg["MATH_HUE"] = "230";
Blockly.Msg["LOOPS_HUE"] = "120";
Blockly.Msg["LISTS_HUE"] = "260";
Blockly.Msg["LOGIC_HUE"] = "210";
Blockly.Msg["VARIABLES_HUE"] = "330";
Blockly.Msg["TEXTS_HUE"] = "160";
Blockly.Msg["PROCEDURES_HUE"] = "290";
Blockly.Msg["COLOUR_HUE"] = "20";
Blockly.Msg["VARIABLES_DYNAMIC_HUE"] = "310";</script>

<style>
textarea{
    overflow-x: scroll;
    white-space: nowrap;
    height: 200px;
    width:100%;
}
pre#textarea_ahk{
    background-color: #eee;
    border-radius: 10px;
    padding: 10px;
    overflow-y: scroll;
    height: 200px;
    margin: 0;
    font-size: 15px;
}
button{
    height: 30px;
    border-radius: 6px;
    text-align: center;
    font-family: 微軟正黑體;
    font-size: 15px;
    font-weight: bold;
    margin-top: 8px;
    margin-right: 8px;
    text-shadow: #fff 1px 1px 1px;
    outline: none;
}
#div_show_ahk_btns{
    margin-bottom: 8px;
}
#div_show_ahk_area{
    margin: 10px 0;
}
.float_right{
    float: right;
}
input#input_var{
    height: 20px;
    margin-top: 10px;
    width: 80px;
    margin-right: 8px;
}
button.disabled{
    color:gray !important;
}
</style>
</head>
 
<body onload="brython(1)">

<script type="text/python">
from browser import document as doc
from browser.html import *
from browser import bind,window,alert,ajax
#過渡JS物件和函式
log=window.console.log
FormatHTML=window.FormatHTML
DownloadTextFile=window.DownloadTextFile
Blockly=window.Blockly
workspace=window.workspace

#將介面改為桌機瀏覽模式 (因此手機上可以編輯文字拼圖)
Blockly.utils.userAgent.MOBILE=False
Blockly.utils.userAgent.ANDROID=False
Blockly.utils.userAgent.IPAD=False

#全域變數
#縮排
TAB_SPACE="    "


#定義動作:複製文字 #不需要建立外部額外元素
def CopyTextToClipborad(string):
    textarea_elt_forCopyText=TEXTAREA()
    textarea_elt_forCopyText.text=string
    doc<=textarea_elt_forCopyText
    textarea_elt_forCopyText.select()
    doc.execCommand("copy")
    textarea_elt_forCopyText.remove()

#定義函式:將xml格式化
def FormatXML(xml_str):
    xml_str=FormatHTML(xml_str)
    xml_str_line_list=xml_str.split('\n')
    xml_str_line_list=[xml_str_line for xml_str_line in xml_str_line_list if xml_str_line.strip()!=""]
    return "\n".join(xml_str_line_list)

#定義動作:尋找該層下的選擇器
def FindCurrent(elt,css_selector,get_one=True):
    com_elt_list=[elt_child for elt_child in elt.select(css_selector) if elt_child.parent==elt]
    if get_one:
        if com_elt_list:
            return com_elt_list[0]
        else:
            return None
    else:
        return com_elt_list

#設置解析xml用的隱藏div容器
div_xml_elt=DIV(id="div_xml",style={'display':'none'})
doc<=div_xml_elt

#定義動作:轉換xml為block
def XmlToBlockly(ev):
    #若xml的更改事件不是起源於blockly，就繼續執行
    if not hasattr(ev,"changeStartFromBlockly"):
        #print('xml>block')
        #獲取textarea_xml元素中的xml_str
        textarea_elt=doc['textarea_xml']
        xml_str=textarea_elt.value
        #製作臨時div容器以生成xml元素
        div_xml_elt=doc["div_xml"]
        div_xml_elt.innerHTML=xml_str
        xml_elt=div_xml_elt.select_one('xml')
        #若xml元素產生成功，就將xml元素嵌入至blockly區塊顯示
        if xml_elt:
            Blockly.Xml.clearWorkspaceAndLoadFromXml(xml_elt,workspace)

        #輸出格式化xml到
        textarea_elt.value=FormatXML(textarea_elt.value)
    
#定義動作:顯示blocks的xml (必須等待Block載入完成)
def BlocklyToXml(ev):
    #啟用複製和下載AHK檔案按鈕
    for btn_elt in doc['div_copy_ahkfile_btns_area'].select('button'):
        if hasattr(btn_elt,'style_save'):
            btn_elt.style=btn_elt.style_save
        btn_elt.disabled=False
        btn_elt.classList.remove('disabled')
    #print('block>xml')
    #自blockly獲取xml_str
    xml_blockly_elt=Blockly.Xml.workspaceToDom(workspace)
    doc['textarea_xml'].value=FormatXML(xml_blockly_elt.outerHTML)
    #製作input事件，觸發XmlToAHK，並附加起源資訊到事件元素中
    input_ev = window.Event.new("input")
    input_ev.changeStartFromBlockly=True
    doc['textarea_xml'].dispatchEvent(input_ev)

#定義動作:轉譯xml為AHK語法
def XmlToAHK(ev):
    ##註冊物件型Block元素列表 (不能被獨立轉譯)
    OBJ_BLOCK_LIST=[
        'function_key',
        'special_key',
        'normal_key',
        'filepath',
        'text',
        'webpage',
        'built_in_program',
        'built_in_dirpath',
        'built_in_webpage',
        'path_combined',
        'built_in_time',
        'math_arithmetic',
        'math_number',
        'variables_get',
    ]

    if ev.type in ["input","click"]:
        #print('xml>ahk')
        # print('XmlToAHK',"ev.type:",ev.type)
        #至textarea_xml元素獲取xml
        textarea_xml_elt=ev.currentTarget
        xml_str=textarea_xml_elt.value
        #獲取要輸出到指定的textarea元素
        textarea_ahk_elt=doc['textarea_ahk']

        #生成AHK程式碼
        ahk_code=""
        #建立暫時的div容器用來解析xml
        div_parseXml_elt=DIV()
        div_parseXml_elt.innerHTML=xml_str
        block_elt_list=div_parseXml_elt.select('xml>block')
        for block_elt in block_elt_list:
            #不要轉譯落單的field block
            if block_elt.attrs['type'] not in OBJ_BLOCK_LIST:
                ahk_code+=AHK_block(block_elt)+'\n'

        textarea_ahk_elt.innerHTML=ahk_code

        #移除暫時的div容器
        del div_parseXml_elt


#定義函式:抽出元素的註解
def Comment(elt,get_all_comment=False):
    com_str=""
    commit_elt_list=[]
    #判斷輸入的元素是否存在
    if elt:
        if get_all_comment:
            commit_elt_list=elt.select('comment')
        else:
            #搜尋該層下的comment
            commit_elt=FindCurrent(elt,'comment')
            #判斷該元素是否有comment
            if commit_elt:
                commit_elt_list.append(commit_elt)
        for commit_elt in commit_elt_list:
            commit_str=commit_elt.text
            #處理多行註解
            commit_str=commit_str.replace('\n','\n;')
            com_str+=f";{commit_str}\n"
            commit_elt.remove()
    
    return com_str

#定義函式:解析value元素為AHK語法
def AHK_value(value_elt,get_all_comment=False):
    if value_elt:
        block_underValue_elt=value_elt.select_one('block')
        return AHK_block(block_underValue_elt,get_all_comment=get_all_comment,separate_comment=True)
    else:
        return ("","")

#定義函式:解析statement元素為AHK語法
def AHK_statement(statement_elt,for_hotkey=False):
    com_str=""
    if statement_elt:
        block_underStatement_elt=FindCurrent(statement_elt,'block')
        if block_underStatement_elt:
            statement_str=AHK_block(block_underStatement_elt)
            if for_hotkey:
                if statement_str.count('\n')>1 :
                    com_str+=f'\n{statement_str}Return\n'
                else:
                    com_str+=f"{statement_str}"
            else:
                #處理執行式縮排
                statement_str=TAB_SPACE+statement_str.replace("\n","\n"+TAB_SPACE)
                #去除執行式中空白的文字行
                statement_str='\n'.join([statement_str for statement_str in statement_str.split('\n') if statement_str.replace(';','').strip()!=""])+'\n'
                com_str+=statement_str
    return com_str


#定義函式:解析block元素為AHK語法
def AHK_block(block_elt,get_all_comment=False,separate_comment=False):
    com_str=""
    comment_str=""

    #判斷是否要轉譯該Block
    block_is_disabled_bool=True
    if block_elt:
        if block_elt.attrs.get("disabled",None):
            if block_elt.attrs["disabled"]=="true":
                block_is_disabled_bool=True
            else:
                block_is_disabled_bool=False        
        else:
            block_is_disabled_bool=False

    #若需要轉譯
    if not block_is_disabled_bool:
        comment_str+=Comment(block_elt,get_all_comment=get_all_comment)

        #region 按鍵Blockly

        if block_elt.attrs['type']=="hotkey_execute":
            hotkey_str=""
            statement_str=""

            value_elt=FindCurrent(block_elt,'value[name="NAME"]')
            if value_elt:
                #獲取功能鍵
                block_functionKey_elt_list=value_elt.select('block[type="function_key"]')
                for block_functionKey_elt in block_functionKey_elt_list:
                    functionKey_str,functionKey_comment=AHK_block(block_functionKey_elt,separate_comment=True)
                    hotkey_str+=functionKey_str
                    com_str+=functionKey_comment
                #獲取一般鍵
                block_normalKey_elt_list=value_elt.select('block[type="normal_key"]')
                block_normalKey_elt_list.extend(value_elt.select('block[type="special_key"]'))
                for block_normalKey_elt in block_normalKey_elt_list:
                    normalKey_str,normalKey_comment=AHK_block(block_normalKey_elt,separate_comment=True)
                    hotkey_str+=normalKey_str
                    com_str+=normalKey_comment
                #獲取執行元素
                statement_elt=FindCurrent(block_elt,'statement[name="DO"]')
                if statement_elt:
                    statement_str=AHK_statement(statement_elt,for_hotkey=True)
                    
            com_str+=hotkey_str+f"::{statement_str}\n"
                
        elif block_elt.attrs['type']=="function_key":
            field_elt=FindCurrent(block_elt,'field')
            function_key_name=field_elt.text
            function_key_dict={
                'Ctrl':'^',
                'Shift':'+',
                'Alt':'!',
                'Win':'#',
                'R':'>',
                'L':'<',
            }
            for k,v in function_key_dict.items():
                function_key_name=function_key_name.replace(k,v)
            com_str+=function_key_name

        elif block_elt.attrs['type'] in ["normal_key","special_key"]:
            field_elt=FindCurrent(block_elt,'field')
            function_key_name=field_elt.text
            com_str+=function_key_name
        
        #endregion 按鍵Blockly

        #region 熱字串Blockly
        elif block_elt.attrs['type'] in ["hotstring","hotstring_advanced"]:
            #獲取縮寫元素
            value_abb_elt=FindCurrent(block_elt,'value[name="ABB"]')
            value_abb_str,value_abb_comment=AHK_value(value_abb_elt)
            value_abb_str=value_abb_str[1:-1] #去除冒號
            com_str+=value_abb_comment
            #獲取展開文字元素
            value_text_elt=FindCurrent(block_elt,'value[name="TEXT"]')
            value_text_str,value_text_comment=AHK_value(value_text_elt)
            #去除冒號(只針對文字進行去除，不針對變量或函式)
            if value_text_str[0]==value_text_str[-1]=='"':
                value_text_str=value_text_str[1:-1] 
            com_str+=value_text_comment
            #獲取熱字串設定元素
            hotstring_setting_str=""
            expand_raw_text_bool=False
            statement_setting_elt=FindCurrent(block_elt,'statement[name="SETTING"]')
            if statement_setting_elt:
                hotstringSetting_dict={
                    "hotstringSetting_autoExpaned":"*",
                    "hotstringSetting_dontFireEndKey":"o",
                    "hotstringSetting_caseSensitive":"c",
                    "hotstringSetting_expanedInWrods":"?",
                }
                block_hotstringSetting_elt_list=statement_setting_elt.select('block')
                for block_hotstringSetting_elt in block_hotstringSetting_elt_list:
                    if block_hotstringSetting_elt.attrs['type']!="hotstringSetting_rawText":
                        hotstring_setting_symbol=hotstringSetting_dict[block_hotstringSetting_elt.attrs['type']]
                        hotstring_setting_str+=hotstring_setting_symbol
                    else:
                        expand_raw_text_bool=True
            #若要展開的文字元素不是文字(例如變數或函式返回值)，則換至下一行使用SendInput TEXT
            if value_text_elt and FindCurrent(value_text_elt,'block') and FindCurrent(value_text_elt,'block').attrs['type']!="text":
                com_str+=f':{hotstring_setting_str}:{value_abb_str}::\nSendInput % "{{TEXT}}" . {value_text_str}\nReturn\n'
            else:
                com_str+=f':{hotstring_setting_str}:{value_abb_str}::{f"{{TEXT}}"*expand_raw_text_bool}{value_text_str}\n'
        
        elif block_elt.attrs['type']=="hotstring_do":
            #獲取縮寫元素
            value_abb_elt=FindCurrent(block_elt,'value[name="ABB"]')
            value_abb_str,value_abb_comment=AHK_value(value_abb_elt)
            value_abb_str=value_abb_str[1:-1] #去除冒號
            com_str+=value_abb_comment
            #獲取執行內容元素
            statement_do_elt=FindCurrent(block_elt,'statement[name="DO"]')
            statement_do_str=AHK_statement(statement_do_elt,for_hotkey=True)
            #獲取熱字串設定元素
            hotstring_setting_str=""
            statement_setting_elt=FindCurrent(block_elt,'statement[name="SETTING"]')
            if statement_setting_elt:
                #獲取熱字串設定元素中的註解
                comment_setting_elt_list=statement_setting_elt.select('comment')
                for comment_setting_elt in comment_setting_elt_list:
                    com_str+=Comment(comment_setting_elt.parent)
                hotstringSetting_dict={
                    "hotstringSetting_autoExpaned":"*",
                    "hotstringSetting_dontFireEndKey":"o",
                    "hotstringSetting_caseSensitive":"c",
                    "hotstringSetting_expanedInWrods":"?",
                }
                block_hotstringSetting_elt_list=statement_setting_elt.select('block')
                for block_hotstringSetting_elt in block_hotstringSetting_elt_list:
                    if block_hotstringSetting_elt.attrs['type']!="hotstringSetting_rawText":
                        hotstring_setting_symbol=hotstringSetting_dict[block_hotstringSetting_elt.attrs['type']]
                        hotstring_setting_str+=hotstring_setting_symbol

            com_str+=f':{hotstring_setting_str}:{value_abb_str}::{statement_do_str}\n'

        #endregion 熱字串Blockly

        
        #region 動作Blockly
        
        elif block_elt.attrs['type']=="open":
            value_elt=FindCurrent(block_elt,'value[name="NAME"]')
            value_str,value_comment=AHK_value(value_elt,get_all_comment=True)

            com_str+=value_comment
            com_str+=f'Run % {value_str}\n'

        elif block_elt.attrs['type']=="file_recycle_empty":
            com_str+='FileRecycleEmpty\n'

        elif block_elt.attrs['type']=="msgbox":
            value_elt=FindCurrent(block_elt,'value')
            value_str,value_comment=AHK_value(value_elt,get_all_comment=True)

            com_str+=value_comment

            com_str+=f"Msgbox % {value_str}\n"

        elif block_elt.attrs['type']=="send_text":
            value_elt=FindCurrent(block_elt,'value')
            value_str,value_comment=AHK_value(value_elt,get_all_comment=True)

            com_str+=value_comment
            com_str+=f'SendInput % "{{TEXT}}" . {value_str}\n'
            
        elif block_elt.attrs['type']=="close_process":
            field_elt=FindCurrent(block_elt,'field')
            com_str+=f'Process, Close, {field_elt.text}\n'

        #endregion 動作Blockly


        #region 物件Blockly

        #目錄、檔案、網頁
        elif block_elt.attrs['type'] in ["filepath","dirpath","webpage"]:
            filed_elt=FindCurrent(block_elt,'field[name="NAME"]')
            filed_str=filed_elt.text
            #若為網頁，則需要替換特殊字元
            if block_elt.attrs['type']=="webpage":
                filed_str=filed_str.replace("%","`%").replace(",","`,")
            com_str+=f'"{filed_str}"'
        
        #文字
        elif block_elt.attrs['type']=="text":
            field_elt=FindCurrent(block_elt,'field')
            field_elt_str=field_elt.text.replace('`','``')
            if field_elt:
                com_str+=f'"{field_elt_str}"'

        #合併文字
        elif block_elt.attrs['type']=="text_join":
            mutation_elt=FindCurrent(block_elt,"mutation")
            mutation_items_int=int(mutation_elt.attrs['items'])
            value_str_list=[]
            for i_item in range(mutation_items_int):
                value_elt=FindCurrent(block_elt,f'value[name="ADD{i_item}"]')
                value_str,value_comment=AHK_value(value_elt)
                value_str_list.append(value_str)
            
            value_str_list_str=" . ".join(value_str_list)
            com_str+=value_str_list_str


        #內建程式變量
        elif block_elt.attrs['type']=="built_in_program":
            field_elt=FindCurrent(block_elt,'field')
            if field_elt:
                built_in_program_dict={
                    "notepad":'"Notepad.exe"',
                    "mspaint":' windir . "\system32\mspaint.exe"',
                    "calc":' windir . "\system32\calc.exe"',
                    "SnippingTool":' windir . "\system32\SnippingTool.exe"',
                    "cmd":' windir . "\system32\cmd.exe"',
                    "ahkfile":'A_ScriptFullPath',
                    "ahkexe":'A_AhkPath',
                }
                field_str=built_in_program_dict[field_elt.text]
                com_str+=f'{field_str}'

        #內建路徑變量
        elif block_elt.attrs['type']=="built_in_dirpath":
            field_elt=FindCurrent(block_elt,'field')
            if field_elt:
                built_in_program_dict={
                    "desktop":'A_Desktop',
                    "mydocuments":'A_MyDocuments',
                    "startup":'A_Startup',
                    "temp":'A_Temp',
                    "windows":'A_WinDir',
                    "ahkfilepath":'A_ScriptDir',
                }
                field_str=built_in_program_dict[field_elt.text]
                com_str+=f'{field_str}'

        elif block_elt.attrs['type']=="built_in_webpage":
            field_elt=FindCurrent(block_elt,'field')
            if field_elt:
                built_in_webpage_dict={
                    "google":'https://www.google.com',
                    "youtube":'https://www.youtube.com',
                    "facebook":'https://www.facebook.com',
                    "wikipedia":'https://zh.wikipedia.org',
                    "pchome":"https://www.pchome.com.tw",
                    "yahoo":"https://yahoo.com",
                    "googlemap":"https://www.google.com.tw/maps",
                    "ahk":"https://www.autohotkey.com",
                    "ahkblockly":"https://sites.google.com/view/ahktool/ahkblockly",
                }
                field_str=built_in_webpage_dict[field_elt.text]
                com_str+=f'"{field_str}"'

        #路徑合併
        elif block_elt.attrs['type']=="path_combined":
            value_mainPath_elt=FindCurrent(block_elt,'value[name="main_path"]')
            value_mainPath_str,value_mainPath_comment=AHK_value(value_mainPath_elt)
            com_str+=value_mainPath_comment

            value_subPath_elt=FindCurrent(block_elt,'value[name="sub_path"]')
            value_subPath_str,value_subPath_comment=AHK_value(value_subPath_elt)
            com_str+=value_subPath_comment
            
            com_str+=f'{value_mainPath_str} . "\\" . {value_subPath_str}'

        #數字
        elif block_elt.attrs['type']=="math_number":
            field_elt=FindCurrent(block_elt,'field[name="NUM"]')
            com_str+=field_elt.text.strip()

        #數學算式
        elif block_elt.attrs['type']=="math_arithmetic":
            field_op_elt=FindCurrent(block_elt,'field[name="OP"]')
            field_op_str_dict={
                'ADD':'+',
                'MINUS':'-',
                'MULTIPLY':'*',
                'DIVIDE':'/',
                'POWER':'**',
            }
            field_op_str=field_op_str_dict[field_op_elt.text]

            value_a_elt=FindCurrent(block_elt,'value[name="A"]')
            value_a_str,_=AHK_value(value_a_elt)
            
            value_b_elt=FindCurrent(block_elt,'value[name="B"]')
            value_b_str,_=AHK_value(value_b_elt)

            com_str+=f'({value_a_str}{field_op_str}{value_b_str})'



        #日期時間
        elif block_elt.attrs['type']=="built_in_time":
            field_elt=FindCurrent(block_elt,'field[name="NAME"]')
            built_in_time_dict={
                "year":"A_YYYY",
                "month":"A_MM",
                "day":"A_DD",
                "wday":"A_WDay",
                "hour":"A_Hour",
                "min":"A_Min",
                "sec":"A_Sec",
            }
            com_str+=built_in_time_dict[field_elt.text]


        #endregion 物件Blockly

        
        #region 模擬鍵盤Blockly
        elif block_elt.attrs['type']=="send_key":
            hotkey_str=""

            #移除next元素(使用虛擬DIV容器)
            block_sendKey_elt=DIV()
            block_sendKey_elt.innerHTML=block_elt.innerHTML
            next_sendKey_elt=block_sendKey_elt.select_one('next')
            if next_sendKey_elt:
                next_sendKey_elt.remove()
            #獲取功能鍵
            block_functionKey_elt_list=block_sendKey_elt.select('block[type="function_key"]')
            for block_functionKey_elt in block_functionKey_elt_list:
                functionKey_str,functionKey_comment=AHK_block(block_functionKey_elt,separate_comment=True)
                hotkey_str+=functionKey_str
                com_str+=functionKey_comment
            #獲取一般鍵(將英文字母按鍵名稱降為小寫)
            block_normalKey_elt_list=block_sendKey_elt.select('block[type="normal_key"]')
            block_normalKey_elt_list.extend(block_sendKey_elt.select('block[type="special_key"]'))
            for block_normalKey_elt in block_normalKey_elt_list:
                normalKey_str,normalKey_comment=AHK_block(block_normalKey_elt,separate_comment=True)
                hotkey_str+=(normalKey_str.lower() if block_normalKey_elt.attrs['type']=="normal_key" else f"{{{normalKey_str}}}")
                com_str+=normalKey_comment
            
            com_str+=f'Send, {hotkey_str}\n'

        elif block_elt.attrs['type']=="send_keys":
            hotkey_str=""

            #移除next元素(使用虛擬DIV容器)
            block_sendKey_elt=DIV()
            block_sendKey_elt.innerHTML=block_elt.innerHTML
            next_sendKey_elt=block_sendKey_elt.select_one('next')
            if next_sendKey_elt:
                next_sendKey_elt.remove()
            #獲取一般連續鍵
            filed_elt=FindCurrent(block_elt,'field')
            
            com_str+=f'Send, {filed_elt.text}\n'

        elif block_elt.attrs['type']=="send_key_times":
            #移除next元素(使用虛擬DIV容器)
            block_sendKey_elt=DIV()
            block_sendKey_elt.innerHTML=block_elt.innerHTML
            next_sendKey_elt=block_sendKey_elt.select_one('next')
            if next_sendKey_elt:
                next_sendKey_elt.remove()
            #獲取功能鍵
            functionKey_all_str=""
            block_functionKey_elt_list=block_sendKey_elt.select('block[type="function_key"]')
            for block_functionKey_elt in block_functionKey_elt_list:
                functionKey_str,functionKey_comment=AHK_block(block_functionKey_elt,separate_comment=True)
                functionKey_all_str+=functionKey_str
                com_str+=functionKey_comment
            #獲取一般鍵(將英文字母按鍵名稱降為小寫)，此處應只有獲取一個元素
            block_normalKey_elt_list=block_sendKey_elt.select('block[type="normal_key"]')
            block_normalKey_elt_list.extend(block_sendKey_elt.select('block[type="special_key"]'))
            for block_normalKey_elt in block_normalKey_elt_list:
                normalKey_str,normalKey_comment=AHK_block(block_normalKey_elt,separate_comment=True)
                if block_normalKey_elt.attrs['type']=="normal_key":
                    normalKey_str=normalKey_str.lower()
                com_str+=normalKey_comment

            #獲取次數元素
            value_times_elt=FindCurrent(block_elt,'value[name="TIMES"]')
            value_times_str,value_times_comment=AHK_value(value_times_elt)
            com_str+=value_times_comment
            
            com_str+=f'Send, {functionKey_all_str}{{{normalKey_str} {value_times_str}}}\n'

        #endregion 模擬鍵盤Blockly

        #region 函式Blockly

        elif block_elt.attrs['type']=="procedures_defnoreturn":
            #獲取函式名稱
            field_name_elt=FindCurrent(block_elt,'field[name="NAME"]')
            function_name_str=field_name_elt.text
            #獲取變數列表
            arg_str_list=[]
            mutation_elt=FindCurrent(block_elt,'mutation')
            if mutation_elt:
                for arg_elt in mutation_elt.select('arg'):
                    arg_str_list.append(arg_elt.attrs['name'])
            arg_str=", ".join(arg_str_list)
            #獲取執行內容
            statement_elt=FindCurrent(block_elt,'statement[name="STACK"]')
            statement_str=AHK_statement(statement_elt)
            #輸出程式碼
            com_str+=f'{function_name_str}({arg_str}){{\n{statement_str}}}\n'

        elif block_elt.attrs['type']=="procedures_defreturn":
            #獲取函式名稱
            field_name_elt=FindCurrent(block_elt,'field[name="NAME"]')
            function_name_str=field_name_elt.text
            #獲取變數列表
            arg_str_list=[]
            mutation_elt=FindCurrent(block_elt,'mutation')
            if mutation_elt:
                for arg_elt in mutation_elt.select('arg'):
                    arg_str_list.append(arg_elt.attrs['name'])
            arg_str=", ".join(arg_str_list)
            #獲取執行內容
            statement_elt=FindCurrent(block_elt,'statement[name="STACK"]')
            statement_str=AHK_statement(statement_elt)
            #獲取返回內容
            value_return_elt=FindCurrent(block_elt,'value[name="RETURN"]')
            value_return_str,value_return_comment=AHK_value(value_return_elt)
            value_return_str=TAB_SPACE + f'Return {value_return_str}\n'
            com_str+=value_return_comment
            #輸出程式碼
            com_str+=f'{function_name_str}({arg_str}){{\n{statement_str}{value_return_str}}}\n'
        

        elif block_elt.attrs['type']=="procedures_callnoreturn":
            #獲取函式名稱
            mutation_elt=block_elt.select_one('mutation')
            function_name_str=mutation_elt.attrs['name']
            #獲取變數列表
            arg_elt_list=mutation_elt.select('arg')
            arg_str_list=[]
            for i_arg in range(len(arg_elt_list)):
                #獲取參數數值
                value_arg_elt=FindCurrent(block_elt,f'value[name="ARG{i_arg}"]')
                value_arg_str,_=AHK_value(value_arg_elt)
                value_arg_str=value_arg_str if value_arg_str else ""
                #獲取參數名稱
                arg_elt=arg_elt_list[i_arg]
                arg_name_str=arg_elt.attrs['name']
                #生成「參數:=數值」表達式
                arg_str=f'{arg_name_str}:={value_arg_str}'
                arg_str_list.append(arg_str)
            arg_str_list_str=", ".join(arg_str_list)
            com_str+=f'{function_name_str}({arg_str_list_str})\n' #沒有return是執行式，所以要換行

        elif block_elt.attrs['type']=="procedures_callreturn":
            #獲取函式名稱
            mutation_elt=block_elt.select_one('mutation')
            function_name_str=mutation_elt.attrs['name']
            #獲取變數列表
            arg_elt_list=mutation_elt.select('arg')
            arg_str_list=[]
            for i_arg in range(len(arg_elt_list)):
                #獲取參數數值
                value_arg_elt=FindCurrent(block_elt,f'value[name="ARG{i_arg}"]')
                value_arg_str,_=AHK_value(value_arg_elt)
                value_arg_str=value_arg_str if value_arg_str else ""
                #獲取參數名稱
                arg_elt=arg_elt_list[i_arg]
                arg_name_str=arg_elt.attrs['name']
                #生成「參數:=數值」表達式
                arg_str=f'{arg_name_str}:={value_arg_str}'
                arg_str_list.append(arg_str)
            arg_str_list_str=", ".join(arg_str_list)
            
            com_str+=f'{function_name_str}({arg_str_list_str})' #有return東西會向左賦值，所以不用換行


        #endregion 函式Blockly

        #region 變數Blockly
        elif block_elt.attrs['type']=="variables_get":
            com_str+=block_elt.select_one('field').text

        elif block_elt.attrs['type']=="variables_set":
            #獲取變數名稱
            field_elt=FindCurrent(block_elt,'field[name="VAR"]')
            var_name=field_elt.text
            #獲取賦值內容
            value_elt=FindCurrent(block_elt,'value[name="VALUE"]')
            value_str,value_comment=AHK_value(value_elt)
            com_str+=value_comment
            #輸出程式
            com_str+=f'{var_name} := {value_str}\n'


        #endregion 變數Blockly

        


        #處理下一個block
        next_elt=FindCurrent(block_elt,'next',get_one=True)
        if next_elt:
            block_next_elt=FindCurrent(next_elt,'block')
            com_str+=AHK_block(block_next_elt)

    if separate_comment:
        return  com_str,comment_str   
    else:
        return comment_str+com_str



#綁定事件:workspace更換時就轉譯blocks為xml
def ClearAhkCodeArea(ev):
    #清空AHK code
    doc['textarea_ahk'].innerHTML=""
    #禁用複製和下載AHK檔案按鈕
    for btn_elt in doc['div_copy_ahkfile_btns_area'].select('button'):
        btn_elt.classList.add('disabled')
        btn_elt.disabled=True

workspace.addChangeListener(ClearAhkCodeArea)

#綁定事件:停用落單的blockly
#workspace.addChangeListener(Blockly.Events.disableOrphans);

#範例
xml_ex_1='''<xml>
  <block type="procedures_defreturn" id="qlK:U]~IEWC+1@gAN:lK" x="24" y="23">
    <mutation statements="false"></mutation>
    <field name="NAME">現在時間</field>
    <comment pinned="false" h="80" w="160">請按右鍵＞創造函式積木
來使用此函式積木</comment>
    <value name="RETURN">
      <block type="text_join" id="8X0.OxgdRV2Q2QE8mMFT">
        <mutation items="11"></mutation>
        <value name="ADD0">
          <block type="built_in_time" id="3*b_Ao:WS1JMA~pdCo@1">
            <field name="NAME">year</field>
          </block>
        </value>
        <value name="ADD1">
          <block type="text" id="s)pS:L;BF`;kflQBLVNR">
            <field name="TEXT">/</field>
          </block>
        </value>
        <value name="ADD2">
          <block type="built_in_time" id="N)U2e8AB{xaJHW!c;h#/">
            <field name="NAME">month</field>
          </block>
        </value>
        <value name="ADD3">
          <block type="text" id="Hin^|y$w@)Bz-3fxYJo_">
            <field name="TEXT">/</field>
          </block>
        </value>
        <value name="ADD4">
          <block type="built_in_time" id="Tfi4BII%@Ap31W]Fg9%l">
            <field name="NAME">day</field>
          </block>
        </value>
        <value name="ADD5">
          <block type="text" id="r_0%Xpw_71L_L[Ao-8oo">
            <field name="TEXT">-</field>
          </block>
        </value>
        <value name="ADD6">
          <block type="built_in_time" id="G|$^aoRw?.-nvdlw)h!-">
            <field name="NAME">hour</field>
          </block>
        </value>
        <value name="ADD7">
          <block type="text" id="Z!nnU}TwQHz|QeNz_J=|">
            <field name="TEXT">:</field>
          </block>
        </value>
        <value name="ADD8">
          <block type="built_in_time" id="14gg/Elks,(H;_T}(=lO">
            <field name="NAME">min</field>
          </block>
        </value>
        <value name="ADD9">
          <block type="text" id="]h^=X9AaM^g5^w/CakfK">
            <field name="TEXT">:</field>
          </block>
        </value>
        <value name="ADD10">
          <block type="built_in_time" id="mpTd{yebnp:R/%H30rj3">
            <field name="NAME">sec</field>
          </block>
        </value>
      </block>
    </value>
  </block>
  <block type="procedures_defreturn" id="[ZFzaKc.WVOfgb*~E4X4" x="438" y="116">
    <mutation statements="false"></mutation>
    <field name="NAME">現在日期</field>
    <comment pinned="false" h="80" w="160">請按右鍵＞創造函式積木
來使用此函式積木</comment>
    <value name="RETURN">
      <block type="text_join" id=".wPxQ{%A/.TkGGUS:/l@">
        <mutation items="7"></mutation>
        <value name="ADD0">
          <block type="text" id="8edf;tX{wP:I5]xI5#J6">
            <field name="TEXT">中華民國</field>
          </block>
        </value>
        <value name="ADD1">
          <block type="math_arithmetic" id="krA].qgE(Jj?l-e5{xf=">
            <field name="OP">MINUS</field>
            <comment pinned="false" h="36" w="151">將西元年換算成民國年</comment>
            <value name="A">
              <block type="built_in_time" id="/S==O~?Y~e7=jb2C51fZ">
                <field name="NAME">year</field>
              </block>
            </value>
            <value name="B">
              <block type="math_number" id="7=F;I#5W!4l[Eb5E0+(k">
                <field name="NUM">1911</field>
              </block>
            </value>
          </block>
        </value>
        <value name="ADD2">
          <block type="text" id="`v|z$:CWB/sQ+^pdH{5%">
            <field name="TEXT">年</field>
          </block>
        </value>
        <value name="ADD3">
          <block type="math_arithmetic" id="nz0W2[Z?Tc-^uebU5ErH">
            <field name="OP">MULTIPLY</field>
            <comment pinned="false" h="37" w="155">將「09月」改為「9月」</comment>
            <value name="A">
              <block type="built_in_time" id=":a4vRzNmHkUGvM~GOiI/">
                <field name="NAME">month</field>
              </block>
            </value>
            <value name="B">
              <block type="math_number" id="M=k.jK]pT9IYzBLlYKPe">
                <field name="NUM">1</field>
              </block>
            </value>
          </block>
        </value>
        <value name="ADD4">
          <block type="text" id="3WT_$zY8oDl!1WHN37}~">
            <field name="TEXT">月</field>
          </block>
        </value>
        <value name="ADD5">
          <block type="built_in_time" id="Ba=0#KTsgH`Ijdly#0+q">
            <field name="NAME">day</field>
          </block>
        </value>
        <value name="ADD6">
          <block type="text" id="Z,A}^E`o/6Cyo)m}AqT%">
            <field name="TEXT">日</field>
          </block>
        </value>
      </block>
    </value>
  </block>
  <block type="hotstring" id="TNWAh{Y3xozLNH.7tGxR" x="26" y="369">
    <value name="ABB">
      <block type="text" id="8:Q2t+aU.@:TJJ:CLY^b">
        <field name="TEXT">\\now</field>
      </block>
    </value>
    <value name="TEXT">
      <block type="procedures_callreturn" id="F[M88Yax:0WU4!*Qdg+1">
        <mutation name="現在時間"></mutation>
      </block>
    </value>
  </block>
  <block type="hotstring" id="Lx0J5yJv8G#uLgpx7bO(" x="440" y="370">
    <value name="ABB">
      <block type="text" id="R8UjYUXVQlt@`+d/F=pE">
        <field name="TEXT">\date</field>
      </block>
    </value>
    <value name="TEXT">
      <block type="procedures_callreturn" id="aq{LXI=8j-YmPl}vs0wX">
        <mutation name="現在日期"></mutation>
      </block>
    </value>
  </block>
</xml>'''

#插入變數
def InsertVar(ev):
    doc['textarea_xml'].value=doc['textarea_xml'].value.replace('</xml>',f'<block type="variables_get"><field name="VAR">{doc["input_var"].value}</field></block></xml>')
    XmlToBlockly(window.Event.new("input"))

#插入範本
def ViewEx(ev):
    doc['textarea_xml'].value=xml_ex_1
    XmlToBlockly(window.Event.new("input"))
    #doc['btn_blockToAhk'].click()

#設置AHK語法轉換結果畫面元素
div_showAhkArea_elt=DIV(id="div_show_ahk_area")


#設置橫幅DIV元素，並填充文字和複製、下載按鈕
div_showAhkAreaHeader_elt=DIV(id="div_show_ahk_btns")
div_showAhkAreaHeader_elt<=BUTTON("▼轉換為AHK語法",id="btn_blockToAhk").bind("click",BlocklyToXml)
div_showAhkAreaHeader_elt<=BUTTON("載入範本1").bind("click",ViewEx)
div_showAhkAreaHeader_elt<=BUTTON("插入變數",Class='float_right').bind("click",InsertVar)
div_showAhkAreaHeader_elt<=INPUT(placeholder=" 變數名稱",type="text",id="input_var",Class='float_right')


#定義動作:複製原始碼
def CopyAhkCode(ev):
    ahk_code=doc['textarea_ahk'].innerHTML
    CopyTextToClipborad(ahk_code)
    alert('複製成功!')

#定義動作:下載.ahk檔案
def DownloadAhkCode(ev):
    ahk_code=doc['textarea_ahk'].innerHTML
    filename="myahk.ahk"
    DownloadTextFile(filename,ahk_code)

###
#定義動作:下載ahk.exe執行檔
def DownloadAhkExe(ev):
    host="https://papple23gwebtest.azurewebsites.net"
    btn_elt=ev.currentTarget
    btn_text=btn_elt.text
    btn_elt.text="下載中..."
    #定義完成送出AHK程式碼後的動作
    def on_complete(res):
        #獲取檔名key
        filename_key=res.text
        window.open(f"{host}/dl?filename_key={filename_key}","_parent")
        #恢復按鍵文字訊息
        btn_elt.text=btn_text
        #送出刪除檔案請求
        req = ajax.ajax()
        url=f"{host}/rm?filename_key={filename_key}"
        req.open('GET',url,True)
        req.set_header('content-type','application/x-www-form-urlencoded')
        req.send()
        return #res.text
    #獲取AHK程式碼
    ahk_code=doc['textarea_ahk'].innerHTML
    #獲取作業系統類型(64/32位元)
    btn_elt=ev.currentTarget
    os_type_str=';__32-bit__;\n' if btn_elt.id=="btn_dl32exe" else ';__64-bit__;\n'
    #送出post請求
    req = ajax.ajax()
    req.bind('complete',on_complete)
    url=f"{host}/cp"
    req.open('POST',url,True)
    req.set_header('content-type','application/x-www-form-urlencoded')
    req.send(os_type_str+ahk_code)
    #print(os_type_str+ahk_code)

#設置複製和下載按鈕
div_showAhkAreaBtns_elt=DIV(id="div_copy_ahkfile_btns_area")
div_showAhkAreaBtns_elt<=BUTTON("複製語法").bind("click",CopyAhkCode)
div_showAhkAreaBtns_elt<=BUTTON("下載.ahk檔案",style={'color':'#894500'}).bind("click",DownloadAhkCode)
div_showAhkAreaBtns_elt<=BUTTON("下載.exe檔(32-bit)",style={'color':'#000094'},id="btn_dl32exe").bind("click",DownloadAhkExe)
div_showAhkAreaBtns_elt<=BUTTON("下載.exe檔(64-bit)",style={'color':'#000094'},id="btn_dl64exe").bind("click",DownloadAhkExe)

#排版
div_showAhkArea_elt<=div_showAhkAreaHeader_elt
div_showAhkArea_elt<=PRE(
    id="textarea_ahk",
)
div_showAhkArea_elt<=div_showAhkAreaBtns_elt


#設置XML轉換結果畫面元素
div_textareaXml_elt=DIV(id='input_xml_area',style={"display":"none"})
div_textareaXml_elt
div_textareaXml_elt<=P("xml:")
textarea_showXml_elt=TEXTAREA(
    id="textarea_xml",
)
textarea_showXml_elt.bind('input',XmlToAHK)
textarea_showXml_elt.bind('input',XmlToBlockly)
div_textareaXml_elt<=textarea_showXml_elt

#排版
VERSION="1.3 beta"
h1_title_elt=H1(f"AutoHotKey 積木語法產生器 v{VERSION}",style={"color":"rgb(220, 107, 57)","font-size":"18px"})
doc.body.insertBefore(h1_title_elt,doc['blocklyDiv'])
doc['blocklyDiv'].style.visibility="visible" #載入完Brython後才顯示workspace區塊 (才能一併顯示頁面)
doc<=div_showAhkArea_elt
doc<=div_textareaXml_elt


#首次載入網頁時，解析workspace
BlocklyToXml(window.Event.new("change"))

</script>



<div id="blocklyDiv" style="height: 600px; width: 100%;visibility: hidden;"></div>

<xml xmlns="https://developers.google.com/blockly/xml" id="workspaceBlocks" style="display: none"/>
  <block type="hotkey_execute" id="V%=T0MtVv(niaOO.S|,P" x="78" y="115">
    <value name="NAME">
      <block type="function_key" id="b9-u~;+7!-K-580Or~+C">
        <field name="function_key">Ctrl</field>
        <value name="function_key">
          <block type="function_key" id="tpK4IIa}7lYY^v=KrBY-">
            <field name="function_key">Shift</field>
            <value name="function_key">
              <block type="normal_key" id="N11J1M4.Cun/a7RiaD?i">
                <field name="normal_key">A</field>
              </block>
            </value>
          </block>
        </value>
      </block>
    </value>
    <statement name="DO">
      <block type="open" id="v+E6j.ujEL)ep/vi_uH9">
        <value name="NAME">
          <block type="webpage" id="QGoL];H5:jmH}[9[1nF!">
            <field name="NAME">https://www.autohotkey.com/</field>
          </block>
        </value>
      </block>
    </statement>
  </block>
</xml>

<!--block結構必須要是頭尾封閉的html形式才能正常被偵測-->
<xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">


<!--工具欄-->
<category name="基本">
    <block type="hotkey_execute">
        <value name="NAME">
            <block type="function_key">
            <field name="function_key">Ctrl</field>
            <value name="function_key">
                <block type="function_key">
                <field name="function_key">Shift</field>
                <value name="function_key">
                    <block type="normal_key">
                    <field name="normal_key">A</field>
                    </block>
                </value>
                </block>
            </value>
            </block>
        </value>
        <statement name="DO">
            <block type="open">
            <value name="NAME">
                <block type="webpage">
                <field name="NAME">https://www.autohotkey.com/</field>
                </block>
            </value>
            </block>
        </statement>
    </block>
    <block type="hotkey_execute">
        <comment pinned="true" h="34.44447326660156" w="134.44442749023438">清空資源回收桶</comment>
        <value name="NAME">
            <block type="function_key" id="5SbVV-d66$U%w-pkE/Oa">
            <field name="function_key">Ctrl</field>
            <value name="function_key">
                <block type="function_key" id="?wtrVXxd#VOa`16u]{+W">
                <field name="function_key">Win</field>
                <value name="function_key">
                    <block type="function_key" id="K$V@_QkoaGRJL/cEHpi!">
                    <field name="function_key">Alt</field>
                    <value name="function_key">
                        <block type="normal_key" id="o3FZWp=#nW1:@--``xDc">
                        <field name="normal_key">T</field>
                        </block>
                    </value>
                    </block>
                </value>
                </block>
            </value>
            </block>
        </value>
        <statement name="DO">
            <block type="file_recycle_empty" id=";=(]0kDwE-?ptu3@Gkn:">
            <next>
                <block type="msgbox" id="zMTmYSi(ln79)7S@WZoX">
                <value name="NAME">
                    <block type="text" id="Y3qX:9z`xdS0*gs@6=2]">
                    <field name="TEXT">垃圾桶清除完畢!</field>
                    </block>
                </value>
                </block>
            </next>
            </block>
        </statement>
    </block>
    <block type="open">
        <value name="NAME">
        <block type="filepath">
            <field name="NAME">C:\*.exe</field>
        </block>
        </value>
    </block>
    <block type="built_in_dirpath"></block>
    <block type="built_in_program"></block>
    <block type="built_in_webpage"></block>
    <block type="msgbox" id="CXdLYVD0$PZ]^{p/-qf;" x="88" y="225">
        <value name="NAME">
        <block type="text" id="r9th7Sk{9B+wU87Wt%T6">
            <field name="TEXT">Hello World</field>
        </block>
        </value>
    </block>
    <block type="send_text" id="Mjzo.Lz60~t=9(V)`ZE3" x="88" y="284">
        <value name="NAME">
        <block type="text" id="jm%uw[CaO*0FkFoz~;#[">
            <field name="TEXT">xxxl@gmail.com</field>
        </block>
        </value>
    </block>
    <block type="hotstring">
        <value name="ABB">
            <block type="text">
            <field name="TEXT">btw</field>
            </block>
        </value>
        <value name="TEXT">
            <block type="text">
            <field name="TEXT">By the way</field>
            </block>
        </value>
    </block>
</category>

<category name="熱鍵">
    <block type="hotkey_execute"></block>
    <block type="function_key">
        <field name="function_key">Ctrl</field>
    </block>
    <block type="normal_key">
        <field name="normal_key">A</field>
    </block>
    <block type="special_key"></block>
</category>

<category name="熱字串">
    <block type="hotstring">
        <value name="ABB">
            <block type="text">
            <field name="TEXT">btw</field>
            </block>
        </value>
        <value name="TEXT">
            <block type="text">
            <field name="TEXT">By the way</field>
            </block>
        </value>
    </block>
    <block type="hotstring_advanced">
        <value name="ABB">
            <block type="text">
            <field name="TEXT">btw</field>
            </block>
        </value>
        <value name="TEXT">
            <block type="text">
            <field name="TEXT">By the way</field>
            </block>
        </value>
        <statement name="SETTING">
            <block type="hotstringSetting_autoExpaned">
            <next>
                <block type="hotstringSetting_dontFireEndKey">
                <next>
                    <block type="hotstringSetting_caseSensitive">
                    <next>
                        <block type="hotstringSetting_expanedInWrods">
                        <next>
                            <block type="hotstringSetting_rawText"/>
                        </next>
                        </block>
                    </next>
                    </block>
                </next>
                </block>
            </next>
            </block>
        </statement>
    </block>
    <block type="hotstring_do">
        <value name="ABB">
            <block type="text" id="q*bh@i[a]mgtx]X~?yO!">
            <field name="TEXT">\ahk</field>
            </block>
        </value>
        <statement name="DO">
            <block type="msgbox" id="?-yIy#0@{*}2O9g2N.$L">
            <value name="NAME">
                <block type="text" id="[C1MEk_a1dg^m~(;pEWc">
                <field name="TEXT">開啟AHK官網</field>
                </block>
            </value>
            <next>
                <block type="open" id="Dq~*#ls:jX}rD.$O_+2]">
                <value name="NAME">
                    <block type="webpage" id="if^+ZL3Z32V[9Im|X#FV">
                    <field name="NAME">https://www.autohotkey.com/</field>
                    </block>
                </value>
                </block>
            </next>
            </block>
        </statement>
        <statement name="SETTING">
            <block type="hotstringSetting_expanedInWrods" id="h?kFRLgMTM_ej*KwY#E[">
            <next>
                <block type="hotstringSetting_caseSensitive" id="L|^O-W:@2Z@Q)6mEMK08"></block>
            </next>
            </block>
        </statement>
    </block>
    <block type="hotstring"></block>
    <block type="hotstring_advanced"></block>
    <block type="hotstring_do"></block>
    <block type="hotstringSetting_autoExpaned"></block>
    <block type="hotstringSetting_dontFireEndKey"></block>
    <block type="hotstringSetting_caseSensitive"></block>
    <block type="hotstringSetting_expanedInWrods"></block>
    <block type="hotstringSetting_rawText"></block>
</category>

<category name="動作">
    <block type="open"></block>
    <block type="msgbox"></block>
    <block type="send_text"></block>
    <block type="send_key"></block>
    <block type="file_recycle_empty"></block>
    <block type="close_process"></block>
</category>

<category name="物件">
    <block type="filepath">
        <field name="NAME">C:\*.exe</field>
    </block>
    <block type="built_in_program"></block>
    <block type="dirpath"></block>
    <block type="built_in_dirpath"></block>
    <block type="webpage"></block>
    <block type="built_in_webpage"></block>
    <block type="math_number">
        <field name="NUM">123</field>
    </block>
        <block type="text">
        <field name="TEXT">文字</field>
    </block>
    <block type="path_combined">
        <value name="main_path">
        <block type="built_in_dirpath">
            <field name="NAME">desktop</field>
        </block>
        </value>
        <value name="sub_path">
        <block type="filepath">
            <field name="NAME">圖片\01.png</field>
        </block>
        </value>
    </block>
    <block type="built_in_time"></block>   
</category>

<category name="模擬按鍵">
    <block type="send_key"></block>
    <block type="send_keys"></block>
    <block type="send_key_times" id="wltY5@wT{M;nzk*|MC4$" x="109" y="236">
        <value name="KEY">
            <block type="function_key" id="?5{d?c=m$gY):ce8|!!Q">
            <field name="function_key">Ctrl</field>
            <value name="function_key">
                <block type="normal_key" id="?oM./%`gAiAcxPxjQ]};">
                <field name="normal_key">V</field>
                </block>
            </value>
            </block>
        </value>
        <value name="TIMES">
            <block type="math_number" id="m8WbZ`{PQZ@R~tUkLNiC">
            <field name="NUM">3</field>
            </block>
        </value>
    </block>
    <block type="function_key">
    <field name="function_key">Ctrl</field>
    </block>
    <block type="normal_key">
        <field name="normal_key">A</field>
    </block>
    <block type="special_key"></block>
</category>

<category name="文字">
    <block type="msgbox"></block>
    <block type="send_text"></block>
    <block type="text">
        <field name="TEXT">文字</field>
    </block>
    <block type="text_join">
        <mutation items="2"/>
    </block>
</category>

<category name="時間">
    <block type="built_in_time">
        <field name="NAME">year</field>
    </block>
    <block type="built_in_time">
        <field name="NAME">month</field>
    </block>
    <block type="built_in_time">
        <field name="NAME">day</field>
    </block>
</category>

<category name="數學">
    <block type="math_number">
      <field name="NUM">0</field>
    </block>
    <block type="math_arithmetic">
      <field name="OP">ADD</field>
      <value name="A">
        <block type="math_number">
          <field name="NUM">1</field>
        </block>
      </value>
      <value name="B">
        <block type="math_number">
          <field name="NUM">2</field>
        </block>
      </value>
    </block>
</category>

<category name="函式">
    <block type="procedures_defnoreturn">
        <field name="NAME">函式名稱</field>
    </block>
    <block type="procedures_defreturn">
        <field name="NAME">函式名稱</field>
    </block>
    <block type="my_textarea"></block>

</category>

<category name="變數">
    <block type="variables_set">
        <field name="VAR">x</field>
    </block>
    <block type="variables_set">
        <field name="VAR">剪貼簿</field>
    </block>
    <block type="variables_get">
        <field name="VAR">x</field>
    </block>
    <block type="variables_get">
        <field name="VAR">剪貼簿</field>
    </block>
    
    
</category>

</xml>

 
  
</body>

<script>var toolbox = document.getElementById("toolbox");

var options = {
    toolbox: toolbox,
    collapse: true,
    comments: true,
    disable: true,
    maxBlocks: Infinity,
    trashcan: true,
    horizontalLayout: false,
    toolboxPosition: 'start',
    css: true,
    media: 'https://blockly-demo.appspot.com/static/media/',
    rtl: false,
    scrollbars: true,
    sounds: true,
    oneBasedIndex: true,
    grid: {
        spacing: 20,
        length: 1,
        colour: '#888',
        snap: false
    },
    zoom: {
        controls: true,
        wheel: false,
        startScale: 1,
        maxScale: 3,
        minScale: 0.3,
        scaleSpeed: 1.2
    }
};

var workspace = Blockly.inject(blocklyDiv, options);

var workspaceBlocks = document.getElementById("workspaceBlocks");

Blockly.Xml.domToWorkspace(workspaceBlocks, workspace);</script>
<script src="lib/field_textarea.js"></script>
</html>
{% endverbatim %}